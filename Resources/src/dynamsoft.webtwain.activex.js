!function(){"use strict";function e(e,n,t,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,i)}function n(n){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=n.apply(t,r);function s(n){e(a,i,o,s,u,"next",n)}function u(n){e(a,i,o,s,u,"throw",n)}s(undefined)}))}}var t={exports:{}},r={exports:{}};!function(e){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}(r),function(e){var n=r.exports["default"];function t(){e.exports=t=function(){return r},e.exports.__esModule=!0,e.exports["default"]=e.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,n,t){e[n]=t.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{f({},"")}catch(O){f=function(e,n,t){return e[n]=t}}function d(e,n,t,r){var i=n&&n.prototype instanceof p?n:p,o=Object.create(i.prototype),s=new A(r||[]);return a(o,"_invoke",{value:W(e,t,s)}),o}function T(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var g={};function p(){}function _(){}function h(){}var S={};f(S,u,(function(){return this}));var I=Object.getPrototypeOf,m=I&&I(I(y([])));m&&m!==i&&o.call(m,u)&&(S=m);var E=h.prototype=p.prototype=Object.create(S);function v(e){["next","throw","return"].forEach((function(n){f(e,n,(function(e){return this._invoke(n,e)}))}))}function w(e,t){function r(i,a,s,u){var c=T(e[i],e,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function W(e,n,t){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(t.method=i,t.arg=o;;){var a=t.delegate;if(a){var s=b(a,t);if(s){if(s===g)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var u=T(e,n,t);if("normal"===u.type){if(r=t.done?"completed":"suspendedYield",u.arg===g)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(r="completed",t.method="throw",t.arg=u.arg)}}}function b(e,n){var t=n.method,r=e.iterator[t];if(undefined===r)return n.delegate=null,"throw"===t&&e.iterator["return"]&&(n.method="return",n.arg=undefined,b(e,n),"throw"===n.method)||"return"!==t&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+t+"' method")),g;var i=T(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=undefined),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function C(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function y(e){if(e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var t=-1,r=function n(){for(;++t<e.length;)if(o.call(e,t))return n.value=e[t],n.done=!1,n;return n.value=undefined,n.done=!0,n};return r.next=r}}return{next:D}}function D(){return{value:undefined,done:!0}}return _.prototype=h,a(E,"constructor",{value:h,configurable:!0}),a(h,"constructor",{value:_,configurable:!0}),_.displayName=f(h,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===_||"GeneratorFunction"===(n.displayName||n.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},v(w.prototype),f(w.prototype,c,(function(){return this})),r.AsyncIterator=w,r.async=function(e,n,t,i,o){void 0===o&&(o=Promise);var a=new w(d(e,n,t,i),o);return r.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(E),f(E,l,"Generator"),f(E,u,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var n=Object(e),t=[];for(var r in n)t.push(r);return t.reverse(),function i(){for(;t.length;){var e=t.pop();if(e in n)return i.value=e,i.done=!1,i}return i.done=!0,i}},r.values=y,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,r){return a.type="throw",a.arg=e,n.next=t,r&&(n.method="next",n.arg=undefined),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),g},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),C(t),g}},"catch":function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var r=t.completion;if("throw"===r.type){var i=r.arg;C(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,t){return this.delegate={iterator:y(e),resultName:n,nextLoc:t},"next"===this.method&&(this.arg=undefined),g}},r}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(t);var i=t.exports(),o=i;try{regeneratorRuntime=i}catch(ii){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}var a=window.Dynamsoft,s=a.Lib;function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e){var n=function(e,n){if("object"!==c(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var r=t.call(e,n||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===c(n)?n:String(n)}function f(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function d(e,n,t){return n&&f(e.prototype,n),t&&f(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var T=globalThis.Dynamsoft,g=T.Lib,p="18",_="0";function h(){var e=T.DWT.Host;return g.isString(e)&&""!=e||(T.DWT.Host=e="127.0.0.1"),e}T.navInfoSync.bIE?T.Lib.loaderBarSourceIE:T.Lib.loaderBarSource,String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var S=function(e){var n,t=e,r=t._license||"",i=JSON.parse(JSON.stringify(t._licenseServer)),o=t._sessionPassword,a=0;if(r.startsWith("t")||r.startsWith("f"))a=0;else if(0===r.length||r.startsWith("P")||r.startsWith("L")||r.startsWith("Y")||r.startsWith("A"))a=1;else{a=2;var s=r.indexOf(":");if(-1!=s&&(r=r.substring(s+1)),r.startsWith("DLS2")){var u;try{var c=r.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(f){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(r=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(r=JSON.stringify(r)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var n=0;n<e.length;++n){if(document&&document.createElement){var t=document.createElement("a");t.href=e[n],e[n]=t.href}e[n].lastIndexOf("/")!=e[n].length-1&&(e[n]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),n=u.remark}("200001"===r||r.startsWith("200001-"))&&(i&&i.length||(r="")),r||(a=1)}return 1===a&&(r=""),{lt:a,l:r,ls:i,sp:o,rmk:n}},I=!1,m=!0,E=T.DWT;E.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},E.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},E.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},E.EnumDWT_Cap={CAP_NONE:0,CAP_XFERCOUNT:1,ICAP_COMPRESSION:256,ICAP_PIXELTYPE:257,ICAP_UNITS:258,ICAP_XFERMECH:259,CAP_AUTHOR:4096,CAP_CAPTION:4097,CAP_FEEDERENABLED:4098,CAP_FEEDERLOADED:4099,CAP_TIMEDATE:4100,CAP_SUPPORTEDCAPS:4101,CAP_EXTENDEDCAPS:4102,CAP_AUTOFEED:4103,CAP_CLEARPAGE:4104,CAP_FEEDPAGE:4105,CAP_REWINDPAGE:4106,CAP_INDICATORS:4107,CAP_SUPPORTEDCAPSEXT:4108,CAP_PAPERDETECTABLE:4109,CAP_UICONTROLLABLE:4110,CAP_DEVICEONLINE:4111,CAP_AUTOSCAN:4112,CAP_THUMBNAILSENABLED:4113,CAP_DUPLEX:4114,CAP_DUPLEXENABLED:4115,CAP_ENABLEDSUIONLY:4116,CAP_CUSTOMDSDATA:4117,CAP_ENDORSER:4118,CAP_ALARMS:4120,CAP_ALARMVOLUME:4121,CAP_AUTOMATICCAPTURE:4122,CAP_TIMEBEFOREFIRSTCAPTURE:4123,CAP_TIMEBETWEENCAPTURES:4124,CAP_CLEARBUFFERS:4125,CAP_MAXBATCHBUFFERS:4126,CAP_DEVICETIMEDATE:4127,CAP_POWERSUPPLY:4128,CAP_CAMERAPREVIEWUI:4129,CAP_SERIALNUMBER:4132,CAP_PRINTER:4134,CAP_PRINTERENABLED:4135,CAP_PRINTERINDEX:4136,CAP_PRINTERMODE:4137,CAP_PRINTERSTRING:4138,CAP_PRINTERSUFFIX:4139,CAP_LANGUAGE:4140,CAP_FEEDERALIGNMENT:4141,CAP_FEEDERORDER:4142,CAP_REACQUIREALLOWED:4144,CAP_BATTERYMINUTES:4146,CAP_BATTERYPERCENTAGE:4147,CAP_CAMERASIDE:4148,CAP_SEGMENTED:4149,CAP_CAMERAENABLED:4150,CAP_CAMERAORDER:4151,CAP_MICRENABLED:4152,CAP_FEEDERPREP:4153,CAP_FEEDERPOCKET:4154,CAP_AUTOMATICSENSEMEDIUM:4155,CAP_CUSTOMINTERFACEGUID:4156,ICAP_AUTOBRIGHT:4352,ICAP_BRIGHTNESS:4353,ICAP_CONTRAST:4355,ICAP_CUSTHALFTONE:4356,ICAP_EXPOSURETIME:4357,ICAP_FILTER:4358,ICAP_FLASHUSED:4359,ICAP_GAMMA:4360,ICAP_HALFTONES:4361,ICAP_HIGHLIGHT:4362,ICAP_IMAGEFILEFORMAT:4364,ICAP_LAMPSTATE:4365,ICAP_LIGHTSOURCE:4366,ICAP_ORIENTATION:4368,ICAP_PHYSICALWIDTH:4369,ICAP_PHYSICALHEIGHT:4370,ICAP_SHADOW:4371,ICAP_FRAMES:4372,ICAP_XNATIVERESOLUTION:4374,ICAP_YNATIVERESOLUTION:4375,ICAP_XRESOLUTION:4376,ICAP_YRESOLUTION:4377,ICAP_MAXFRAMES:4378,ICAP_TILES:4379,ICAP_BITORDER:4380,ICAP_CCITTKFACTOR:4381,ICAP_LIGHTPATH:4382,ICAP_PIXELFLAVOR:4383,ICAP_PLANARCHUNKY:4384,ICAP_ROTATION:4385,ICAP_SUPPORTEDSIZES:4386,ICAP_THRESHOLD:4387,ICAP_XSCALING:4388,ICAP_YSCALING:4389,ICAP_BITORDERCODES:4390,ICAP_PIXELFLAVORCODES:4391,ICAP_JPEGPIXELTYPE:4392,ICAP_TIMEFILL:4394,ICAP_BITDEPTH:4395,ICAP_BITDEPTHREDUCTION:4396,ICAP_UNDEFINEDIMAGESIZE:4397,ICAP_EXTIMAGEINFO:4399,ICAP_MINIMUMHEIGHT:4400,ICAP_MINIMUMWIDTH:4401,ICAP_AUTODISCARDBLANKPAGES:4404,ICAP_FLIPROTATION:4406,ICAP_BARCODEDETECTIONENABLED:4407,ICAP_SUPPORTEDBARCODETYPES:4408,ICAP_BARCODEMAXSEARCHPRIORITIES:4409,ICAP_BARCODESEARCHPRIORITIES:4410,ICAP_BARCODESEARCHMODE:4411,ICAP_BARCODEMAXRETRIES:4412,ICAP_BARCODETIMEOUT:4413,ICAP_ZOOMFACTOR:4414,ICAP_PATCHCODEDETECTIONENABLED:4415,ICAP_SUPPORTEDPATCHCODETYPES:4416,ICAP_PATCHCODEMAXSEARCHPRIORITIES:4417,ICAP_PATCHCODESEARCHPRIORITIES:4418,ICAP_PATCHCODESEARCHMODE:4419,ICAP_PATCHCODEMAXRETRIES:4420,ICAP_PATCHCODETIMEOUT:4421,ICAP_FLASHUSED2:4422,ICAP_IMAGEFILTER:4423,ICAP_NOISEFILTER:4424,ICAP_OVERSCAN:4425,ICAP_AUTOMATICBORDERDETECTION:4432,ICAP_AUTOMATICDESKEW:4433,ICAP_AUTOMATICROTATE:4434,ICAP_JPEGQUALITY:4435,ICAP_FEEDERTYPE:4436,ICAP_ICCPROFILE:4437,ICAP_AUTOSIZE:4438,ICAP_AUTOMATICCROPUSESFRAME:4439,ICAP_AUTOMATICLENGTHDETECTION:4440,ICAP_AUTOMATICCOLORENABLED:4441,ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE:4442,ICAP_COLORMANAGEMENTENABLED:4443,ICAP_IMAGEMERGE:4444,ICAP_IMAGEMERGEHEIGHTTHRESHOLD:4445,ICAP_SUPPORTEDEXTIMAGEINFO:4446},E.EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},E.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},E.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},E.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},E.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},E.EnumDWT_ImageType={IT_BMP:0,IT_JPG:1,IT_TIF:2,IT_PNG:3,IT_PDF:4,IT_ALL:5,IT_MULTIPAGE_PDF:7,IT_MULTIPAGE_TIF:8,IT_J2K:14},E.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},E.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},E.EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},E.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},E.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},E.EnumDWT_CapLanguage={TWLG_DAN:0,TWLG_DUT:1,TWLG_ENG:2,TWLG_FCF:3,TWLG_FIN:4,TWLG_FRN:5,TWLG_GER:6,TWLG_ICE:7,TWLG_ITN:8,TWLG_NOR:9,TWLG_POR:10,TWLG_SPA:11,TWLG_SWE:12,TWLG_USA:13,TWLG_USERLOCALE:-1,TWLG_AFRIKAANS:14,TWLG_ALBANIA:15,TWLG_ARABIC:16,TWLG_ARABIC_ALGERIA:17,TWLG_ARABIC_BAHRAIN:18,TWLG_ARABIC_EGYPT:19,TWLG_ARABIC_IRAQ:20,TWLG_ARABIC_JORDAN:21,TWLG_ARABIC_KUWAIT:22,TWLG_ARABIC_LEBANON:23,TWLG_ARABIC_LIBYA:24,TWLG_ARABIC_MOROCCO:25,TWLG_ARABIC_OMAN:26,TWLG_ARABIC_QATAR:27,TWLG_ARABIC_SAUDIARABIA:28,TWLG_ARABIC_SYRIA:29,TWLG_ARABIC_TUNISIA:30,TWLG_ARABIC_UAE:31,TWLG_ARABIC_YEMEN:32,TWLG_BASQUE:33,TWLG_BYELORUSSIAN:34,TWLG_BULGARIAN:35,TWLG_CATALAN:36,TWLG_CHINESE:37,TWLG_CHINESE_HONGKONG:38,TWLG_CHINESE_PRC:39,TWLG_CHINESE_SINGAPORE:40,TWLG_CHINESE_SIMPLIFIED:41,TWLG_CHINESE_TAIWAN:42,TWLG_CHINESE_TRADITIONAL:43,TWLG_CROATIA:44,TWLG_CZECH:45,TWLG_DANISH:0,TWLG_DUTCH:1,TWLG_DUTCH_BELGIAN:46,TWLG_ENGLISH:2,TWLG_ENGLISH_AUSTRALIAN:47,TWLG_ENGLISH_CANADIAN:48,TWLG_ENGLISH_IRELAND:49,TWLG_ENGLISH_NEWZEALAND:50,TWLG_ENGLISH_SOUTHAFRICA:51,TWLG_ENGLISH_UK:52,TWLG_ENGLISH_USA:13,TWLG_ESTONIAN:53,TWLG_FAEROESE:54,TWLG_FARSI:55,TWLG_FINNISH:4,TWLG_FRENCH:5,TWLG_FRENCH_BELGIAN:56,TWLG_FRENCH_CANADIAN:3,TWLG_FRENCH_LUXEMBOURG:57,TWLG_FRENCH_SWISS:58,TWLG_GERMAN:6,TWLG_GERMAN_AUSTRIAN:59,TWLG_GERMAN_LUXEMBOURG:60,TWLG_GERMAN_LIECHTENSTEIN:61,TWLG_GERMAN_SWISS:62,TWLG_GREEK:63,TWLG_HEBREW:64,TWLG_HUNGARIAN:65,TWLG_ICELANDIC:7,TWLG_INDONESIAN:66,TWLG_ITALIAN:8,TWLG_ITALIAN_SWISS:67,TWLG_JAPANESE:68,TWLG_KOREAN:69,TWLG_KOREAN_JOHAB:70,TWLG_LATVIAN:71,TWLG_LITHUANIAN:72,TWLG_NORWEGIAN:9,TWLG_NORWEGIAN_BOKMAL:73,TWLG_NORWEGIAN_NYNORSK:74,TWLG_POLISH:75,TWLG_PORTUGUESE:10,TWLG_PORTUGUESE_BRAZIL:76,TWLG_ROMANIAN:77,TWLG_RUSSIAN:78,TWLG_SERBIAN_LATIN:79,TWLG_SLOVAK:80,TWLG_SLOVENIAN:81,TWLG_SPANISH:11,TWLG_SPANISH_MEXICAN:82,TWLG_SPANISH_MODERN:83,TWLG_SWEDISH:12,TWLG_THAI:84,TWLG_TURKISH:85,TWLG_UKRANIAN:86,TWLG_ASSAMESE:87,TWLG_BENGALI:88,TWLG_BIHARI:89,TWLG_BODO:90,TWLG_DOGRI:91,TWLG_GUJARATI:92,TWLG_HARYANVI:93,TWLG_HINDI:94,TWLG_KANNADA:95,TWLG_KASHMIRI:96,TWLG_MALAYALAM:97,TWLG_MARATHI:98,TWLG_MARWARI:99,TWLG_MEGHALAYAN:100,TWLG_MIZO:101,TWLG_NAGA:102,TWLG_ORISSI:103,TWLG_PUNJABI:104,TWLG_PUSHTU:105,TWLG_SERBIAN_CYRILLIC:106,TWLG_SIKKIMI:107,TWLG_SWEDISH_FINLAND:108,TWLG_TAMIL:109,TWLG_TELUGU:110,TWLG_TRIPURI:111,TWLG_URDU:112,TWLG_VIETNAMESE:113},E.EnumDWT_CapSupportedSizes={TWSS_NONE:0,TWSS_A4LETTER:1,TWSS_B5LETTER:2,TWSS_USLETTER:3,TWSS_USLEGAL:4,TWSS_A5:5,TWSS_B4:6,TWSS_B6:7,TWSS_USLEDGER:9,TWSS_USEXECUTIVE:10,TWSS_A3:11,TWSS_B3:12,TWSS_A6:13,TWSS_C4:14,TWSS_C5:15,TWSS_C6:16,TWSS_4A0:17,TWSS_2A0:18,TWSS_A0:19,TWSS_A1:20,TWSS_A2:21,TWSS_A4:1,TWSS_A7:22,TWSS_A8:23,TWSS_A9:24,TWSS_A10:25,TWSS_ISOB0:26,TWSS_ISOB1:27,TWSS_ISOB2:28,TWSS_ISOB3:12,TWSS_ISOB4:6,TWSS_ISOB5:29,TWSS_ISOB6:7,TWSS_ISOB7:30,TWSS_ISOB8:31,TWSS_ISOB9:32,TWSS_ISOB10:33,TWSS_JISB0:34,TWSS_JISB1:35,TWSS_JISB2:36,TWSS_JISB3:37,TWSS_JISB4:38,TWSS_JISB5:2,TWSS_JISB6:39,TWSS_JISB7:40,TWSS_JISB8:41,TWSS_JISB9:42,TWSS_JISB10:43,TWSS_C0:44,TWSS_C1:45,TWSS_C2:46,TWSS_C3:47,TWSS_C7:48,TWSS_C8:49,TWSS_C9:50,TWSS_C10:51,TWSS_USSTATEMENT:52,TWSS_BUSINESSCARD:53,TWSS_MAXSIZE:54},E.EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},E.EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},E.EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},E.EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},E.EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},E.EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},E.EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},E.EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},E.EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},E.EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4},E.EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},E.EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},E.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},E.EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},E.EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},E.EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},E.EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},E.EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},E.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var v=0,w=1,W=2;E.EnumDWT_FitWindowType={enumFitWindow:v,enumFitWindowHeight:w,enumFitWindowWidth:W};var b=-1,P=0,C=1,A=2,y=3,D=4,O=5,L=6,R=7;E.EnumDWT_PlatformType={enumUnknown:b,enumWindow:P,enumMac:C,enumLinux:A,enumEmbed:y,enumChromeOS:D,enumHarmonyOS:O,enumAndroid:L,enumiOS:R},E.EnumDWT_UploadDataFormat={Binary:0,Base64:1};var F=0,N=1,k=2,x=3,M=4,B=5,G=6,U=7,H=8;E.EnumDWT_MouseShape={Default:F,Hand:N,Crosshair:k,Zoom:x,NWResize:M,EResize:B,NResize:G,Resize:U,Move:H},E.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};var j=1,V=2,K=3,X=4,z=5;E.EnumDWT_InitMsg={Info:j,Error:V,NotInstalledError:K,DownloadError:X,DownloadNotRestartError:z};var Y=0,J=3,q=3,Q=4,Z=4,$=5;E.EnumDWT_Driver={TWAIN:Y,ICA:J,SANE:q,TWAIN_AND_ICA:Q,TWAIN_AND_TWAIN64:Z,TWAIN64:$},E.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14};var ee=0,ne=1;E.EnumDWT_SelectionMode={Single:ee,Multiple:ne},E.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2};var te=0,re=1,ie=2,oe=3;E.EnumDWT_WebsocketReadyState={CONNECTING:te,OPEN:re,CLOSING:ie,CLOSED:oe};var ae=16,se=32,ue=64,ce=128,le=256,fe=512,de=1024,Te=ae|se;E.EnumDWT_DeviceType={TWAINSCANNER:ae,WIATWAINSCANNER:se,TWAINX64SCANNER:ue,ICASCANNER:ce,SANESCANNER:le,ESCLSCANNER:fe,WIFIDIRECTSCANNER:de};var ge=0,pe=1;E.EnumDWT_ServiceType={Wasm:ge,TwainService:pe};var _e=1,he=2,Se=4,Ie=8,me=16,Ee=32;E.EnumDWT_SourceMatchField={SMF_NAME:_e,SMF_TWAINVERSION:he,SMF_TWAINPROTOCOL:Se,SMF_ICAUUID:Ie,SMF_ICAMODULEVERSION:me,SMF_ICALOCATIONTYPE:Ee};var ve=0,we=1,We=2;function be(e){return""==e||!g.isString(e)&&!g.isNumber(e)?I:m}function Pe(e){return e&&!g.isString(e)?m:I}function Ce(e,n,t){return(n=l(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}E.EnumDWT_ExtImageInfo={"default":ve,standard:we,supported:We};var Ae=0,ye=-1,De=-4201,Oe=-5001,Le=-5002,Re=-5003,Fe=-5004,Ne="The Web Socket connection failed.",ke="The input is not a JSON object or JSON styled string.",xe="The object has been disposed.",Me="The task is invalid.",Be="The object need to be disposed.",Ge=function(){function e(){u(this,e)}return d(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[Ae]="Successful.",this._errorMessage[De]=Ne,this._errorMessage[Oe]=ke,this._errorMessage[Le]=xe,this._errorMessage[Re]=Me,this._errorMessage[Fe]=Be}}]),e}();Ce(Ge,"_errorMessage",Object.create(null)),Ge.init();var Ue=function(){function e(n,t){u(this,e),Ce(this,"_code",Ae),this.name="DSError",this.message=null!=t?t:"string"==typeof n?n:Ge.message(n),this._code="string"==typeof n?ye:n}return d(e,[{key:"code",get:function(){return this._code}}]),e}();function He(e){return{code:e._errorCode,message:e._errorString}}var je,Ve=d((function oi(e,n,t,r,i){u(this,oi),this.server=e,this.port=n,this.ssl=t,this.useWS=r,this.protocol=i}));function Ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xe(e,n){return Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},Xe(e,n)}function ze(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Xe(e,n)}function Ye(e,n){if(n&&("object"===c(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Ke(e)}function Je(e){return Je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Je(e)}!function(e){e[e.NONE=0]="NONE",e[e.TRACE=1]="TRACE",e[e.DEBUG=2]="DEBUG",e[e.INFO=4]="INFO",e[e.WARN=8]="WARN",e[e.ERROR=16]="ERROR"}(je||(je={}));var qe=g.getLogger(),Qe=function(){function e(){u(this,e)}return d(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,n){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(n,e);else switch(e){case je.DEBUG:qe.debug(n);break;case je.ERROR:qe.error(n);break;case je.INFO:qe.info(n);break;case je.WARN:qe.warn(n);break;case je.TRACE:qe.trace(n)}}},{key:"trace",value:function(e){this.all(je.TRACE,e)}},{key:"debug",value:function(e){this.all(je.DEBUG,e)}},{key:"info",value:function(e){this.all(je.INFO,e)}},{key:"warn",value:function(e){this.all(je.WARN,e)}},{key:"error",value:function(e){this.all(je.ERROR,e)}}]),e}();Ce(Qe,"_logLevel",je.ERROR),Ce(Qe,"_logFunc",undefined);var Ze=0,$e=1,en=2,nn=3,tn=4,rn=5,on=6,an=function(){function e(n){u(this,e),Ce(this,"_serverInfo",undefined),Ce(this,"_disposed",!1),this._serverInfo=n,this._ref=1}var t,r;return d(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,n){return Qe.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=n(o.mark((function t(e,n,r,i){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe.error("request should be implemented in child class"),e.abrupt("return",Promise.resolve(null));case 2:case"end":return e.stop()}}),t)})));return function(n,t,r,i){return e.apply(this,arguments)}}()},{key:"send",value:(r=n(o.mark((function i(e,n,t){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qe.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),i)}))),function(e,n,t){return r.apply(this,arguments)})},{key:"testConnection",value:(t=n(o.mark((function a(e,n,t,r){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe.error("testConnection should be implemented in child class"),e.abrupt("return",Promise.resolve(undefined));case 2:case"end":return e.stop()}}),a)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){if(this._ref--,this._ref>0)return!1;this._disposed=!0,this._terminate()}},{key:"_terminate",value:function(){}},{key:"addRef",value:function(){this._ref++}}]),e}();function sn(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=Je(e);if(n){var i=Je(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Ye(this,t)}}function un(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function cn(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var ln=g.getLogger(),fn=g.fetch,dn=new WeakSet,Tn=new WeakSet,gn=function(e){ze(s,e);var t,r,i,a=sn(s);function s(){var e;u(this,s);for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return un(Ke(e=a.call.apply(a,[this].concat(t))),Tn),un(Ke(e),dn),e}return d(s,[{key:"send",value:(i=n(o.mark((function c(e,n,t){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ln.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),c)}))),function(e,n,t){return i.apply(this,arguments)})},{key:"requestSync",value:function(e,n,t){return undefined}},{key:"request",value:(r=n(o.mark((function l(e,n,t,r){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",cn(this,Tn,_n).call(this,e,n,t,undefined,undefined,r));case 1:case"end":return i.stop()}}),l,this)}))),function(e,n,t,i){return r.apply(this,arguments)})},{key:"testConnection",value:(t=n(o.mark((function f(e,n,t,r){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",cn(this,Tn,_n).call(this,undefined,undefined,e,n,t,r));case 1:case"end":return i.stop()}}),f,this)}))),function(e,n,r,i){return t.apply(this,arguments)})}]),s}(an);function pn(e){var n=this.serverInfo,t="";return t=n.ssl?"https://":"http://",t+=n.server,n.port&&(t+=":",t+=n.port),e&&(g.startsWith(e,"/")||g.endsWith(t,"/")||(t+="/"),g.endsWith(e,"/")?t+=e.slice(0,-1):t+=e),t}function _n(e,n,t,r,i,o){return hn.apply(this,arguments)}function hn(){return(hn=n(o.mark((function e(n,t,r,i,a,s){var u,c,l;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u=null!=r?r:{},n&&(u.body=n),u.method||(u.method="POST"),s&&(u.timeout=s),c=cn(this,dn,pn).call(this,t),ln.debug("HTTP URL: "+c),e.next=9,fn(c,u,i,a);case 9:return l=e.sent,e.abrupt("return",Promise.resolve(l));case 13:if(e.prev=13,e.t0=e["catch"](0),!(e.t0 instanceof Ue)){e.next=19;break}throw e.t0;case 19:throw new Ue(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,13]])})))).apply(this,arguments)}function Sn(e){try{return"object"===c(e)?e:(e="string"!=typeof e?g.stringify(e):e,g.parse(e))}catch(n){throw n instanceof Ue?n:new Ue(Oe)}}function In(e){return Math.random().toString(16).substring(2,2+e)}function mn(e){var n=[In(8),"-",In(4),"-",In(4),"-",In(4),"-",In(8)];return e&&n.unshift(e),n.join("")}function En(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=Je(e);if(n){var i=Je(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Ye(this,t)}}function vn(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function wn(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var Wn,bn=g.getLogger(),Pn=new WeakSet,Cn=new WeakSet,An=new WeakSet,yn=new WeakSet,Dn=new WeakSet,On=new WeakSet,Ln=new WeakSet,Rn=function(e){ze(c,e);var t,r,i,a,s=En(c);function c(e){var n;return u(this,c),vn(Ke(n=s.call(this,e)),Ln),vn(Ke(n),On),vn(Ke(n),Dn),vn(Ke(n),yn),vn(Ke(n),An),vn(Ke(n),Cn),vn(Ke(n),Pn),Ce(Ke(n),"_defaultRetries",1),Ce(Ke(n),"_ws",Wn),Ce(Ke(n),"_events",{}),Ce(Ke(n),"_bHeartBeatStarted",!1),Ce(Ke(n),"_heartBeatTicks",6e4),n._ws=Wn,n.bUseParentWS=!1,n._tasks=Object.create(null),n}return d(c,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,n,t){return bn.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(a=n(o.mark((function l(e,n,t){var r,i,a,s,u;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=t.client,o.prev=1,(i=t.taskId)!==undefined){o.next=7;break}return o.next=6,n(e,Ze,r._requestTaskId,t);case 6:i=o.sent;case 7:if(a=r._tasks[i]){o.next=11;break}throw bn.error("invalid task id: "+i),new Ue(Re);case 11:return o.next=13,wn(r,Dn,Gn).call(r,!1);case 13:return o.next=15,wn(r,On,Hn).call(r,e,n,t,a);case 15:bn.debug("begin to send data "+i),r.disposed||r._ws.send(e),e=null,bn.debug("end to send data "+i),o.next=27;break;case 21:o.prev=21,o.t0=o["catch"](1),bn.debug("failed to send data."),bn.error(o.t0),delete r._tasks[i],null===(s=a)||void 0===s||null===(u=s.resolver)||void 0===u||u.reject(o.t0.message);case 27:case"end":return o.stop()}}),l,null,[[1,21]])}))),function(e,n,t){return a.apply(this,arguments)})},{key:"request",value:(i=n(o.mark((function f(e,n,t,r){var i,a,s;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=this._defaultRetries,a=null!=n?n:wn(this,yn,Mn),s=null!=t?t:{client:this,userData:this},o.abrupt("return",wn(this,Ln,Vn).call(this,e,a,s,i,!1,undefined,r));case 2:case"end":return o.stop()}}),f,this)}))),function(e,n,t,r){return i.apply(this,arguments)})},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"startHeartBeat",value:function(){var e=this;e._bHeartBeatStarted||(e._bHeartBeatStarted=!0,setTimeout((function(){e._innerSendHeartBeat()}),e._heartBeatTicks))}},{key:"_innerSendHeartBeat",value:(r=n(o.mark((function T(){var e,n,t,r,i;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this,n={client:null,userData:null,taskId:"0",eventTaskId:"0",lastEventTaskId:"0"},t=new ArrayBuffer(14),(r=new DataView(t)).setUint8(0,2),r.setUint8(8,2),r.setUint8(12,123),r.setUint8(13,125),i=new Blob([t]),o.prev=9,o.next=12,wn(e,Ln,Vn).call(e,i,null,n,0,!0);case 12:o.next=16;break;case 14:o.prev=14,o.t0=o["catch"](9);case 16:e.connected&&setTimeout((function(){e._innerSendHeartBeat()}),e._heartBeatTicks);case 17:case"end":return o.stop()}}),T,this,[[9,14]])}))),function(){return r.apply(this,arguments)})},{key:"testConnection",value:function(e,n,t,r){return wn(this,Dn,Gn).call(this,!0,null!=n?n:0,t,r)}},{key:"_terminate",value:(t=n(o.mark((function p(){var e;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(e in bn.debug("terminate WSClient"),this.fireEvent("disposed"),this._tasks)this._tasks[e]!==undefined&&this._tasks[e].resolver&&this._tasks[e].resolver.reject(new Ue(Fe));this._lic_callback=Wn,this._blob_callback=Wn,this._ws&&(this._ws.close(),this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null),this._ws=Wn,this._tasks=Object.create(null);case 8:case"end":return n.stop()}}),p,this)}))),function(){return t.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,n,t){var r=this._events[e];r||(this._events[e]={},r=this._events[e]),g.isString(n)&&g.isFunction(t)&&(r[n]=t)}},{key:"removeEvent",value:function(e,n){var t=this._events[e];t&&g.isString(n)&&delete t[n]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var n,t=this._events[e];if(t){var r=Object.keys(t);for(n=0;n<r.length;n++)g.isFunction(t[r[n]])&&t[r[n]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}]),c}(an);function Fn(e){var n="";return n=e.ssl?"wss://":"ws://",n+=e.server,e.port&&(n+=":",n+=e.port),n}function Nn(e,n,t,r){var i=this;return new g.Promise((function(o,a){try{var s,u;if(r&&(u=setTimeout((function(){s.close();var e=new Ue("createWebSocket timed out.");bn.debug(e.message),a(e)}),r)),e.bUseParentWS){var c=window,l=parent,f=c.WebSocket;try{for(;c!=l&&l&&l.WebSocket;)f=l.WebSocket,c=l.window,l=l.parent}catch(d){f=window.WebSocket}s=t?new f(n,t):new f(n)}else s=t?new WebSocket(n,t):new WebSocket(n);s.onopen=function(){u&&clearTimeout(u),e._ws=s,o(s)},s.onerror=function(e){s.close(),u&&clearTimeout(u),i.fireEvent("error"),a(e)},s.onmessage=function(n){wn(e,An,kn).call(e,e,n.data)},s.onclose=function(e){u&&clearTimeout(u),i.fireEvent("close"),a(e)}}catch(T){throw T instanceof Ue?T:new Ue(T.message)}}))}function kn(e,n){return xn.apply(this,arguments)}function xn(){return(xn=n(o.mark((function e(n,t){var r,i,a,s,u,l,f,d,T;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n,e.prev=1,s={client:r,userData:undefined},"object"===c(t)&&r._blob_callback&&r._blob_callback(t),r._cbToGetTaskId){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,r._cbToGetTaskId(t,en,r._requestTaskId,s);case 8:return u=e.sent,l=!1,e.next=12,r._cbToGetTaskId(u,nn,r._requestTaskId,s);case 12:if(a=e.sent){e.next=21;break}if(!u.Detail||!u.Domain){e.next=17;break}return r._lic_callback&&r._lic_callback(u),e.abrupt("return");case 17:return e.next=19,r._cbToGetTaskId(u,tn,r._requestTaskId,s);case 19:(a=e.sent)&&(l=!0);case 21:if(i=r._tasks[a]){e.next=31;break}if(!l){e.next=27;break}i={},e.next=29;break;case 27:return""!=a&&bn.log("invalid task id: "+a),e.abrupt("return");case 29:e.next=33;break;case 31:if(!i.timedout){e.next=33;break}return e.abrupt("return");case 33:return e.next=35,r._cbToGetTaskId(t,rn,r._requestTaskId,i.ctx);case 35:if((f=e.sent)!==undefined){e.next=40;break}return e.next=39,r._cbToGetTaskId(u,on,r._requestTaskId,i.ctx);case 39:f=e.sent;case 40:f&&!l&&(i.tmid&&clearTimeout(i.tmid),delete r._tasks[a],i.resolver&&i.resolver.resolve(f)),e.next=49;break;case 43:e.prev=43,e.t0=e["catch"](1),bn.debug("failed to handle message."),bn.error(e.t0),delete r._tasks[a],null===(d=i)||void 0===d||null===(T=d.resolver)||void 0===T||T.reject(e.t0.message);case 49:case"end":return e.stop()}}),e,null,[[1,43]])})))).apply(this,arguments)}function Mn(e,n,t){return Bn.apply(this,arguments)}function Bn(){return(Bn=n(o.mark((function e(n,t,r){var i,a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===Ze?3:e.t0===rn?7:9;break;case 3:return(a=Sn(n)).cmdId=null!==(i=a.cmdId)&&void 0!==i?i:mn(),Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Promise.resolve(n),e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gn(e,n,t,r){return Un.apply(this,arguments)}function Un(){return(Un=n(o.mark((function e(n,t,r,i){var a,s,u,c;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(u=this)._connectPromise){e.next=7;break}return e.next=6,u._connectPromise;case 6:return e.abrupt("return");case 7:return t=null!==(a=t)&&void 0!==a?a:this._defaultRetries,r=null!==(s=r)&&void 0!==s?s:100,c=wn(u,Pn,Fn).call(u,u.serverInfo),bn.debug("WebSocket URL: "+c),bn.debug("try to create websocket "+t+"--"+r),u._connectPromise=new g.Promise((function(e,n){var o=function(r){wn(u,Cn,Nn).call(u,u,c,u.serverInfo.protocol,i).then((function(n){e(n)}))["catch"]((function(e){bn.debug("create websocket failed: "+e.message),r<t?a(r):n(e)}))};function a(e,n,t){setTimeout((function(){o(++e)}),r)}o(0)})),e.prev=13,e.next=16,u._connectPromise;case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e["catch"](13),e.t0;case 21:return e.prev=21,u._connectPromise=null,e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[13,18,21,24]])})))).apply(this,arguments)}function Hn(e,n,t,r){return jn.apply(this,arguments)}function jn(){return(jn=n(o.mark((function e(n,t,r,i){var a,s,u,c;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this,s=r.eventTaskId,u=r.lastEventTaskId,s!==undefined){e.next=7;break}return e.next=6,t(n,$e,a._requestTaskId,r);case 6:s=e.sent;case 7:s&&(a._tasks[s]?r&&r.userData&&r.userData.command&&((c=a._tasks[s]).ctx=r,u&&((c=a._tasks[u]).ctx=r)):(c={id:i.id,resolver:null,ctx:r,timedout:!1},a._tasks[s]=c,u&&(a._tasks[u]=c)));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Vn(e,n,t,r,i,o,a){return Kn.apply(this,arguments)}function Kn(){return(Kn=n(o.mark((function e(n,t,r,i,a,s,u){var c,l,f,d;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this,e.prev=1,r.client=c,e.next=5,wn(c,Dn,Gn).call(c,a,i,s,u);case 5:if("0"!=(l=r.taskId)){e.next=12;break}return c.disposed||c._ws.send(n),n=null,e.abrupt("return");case 12:if(l!==undefined){e.next=16;break}return e.next=15,t(n,Ze,null,r);case 15:l=e.sent;case 16:return l===undefined&&bn.debug("websocket send: task id is invalid."),(f={}).promise=new g.Promise((function(e,n){f.resolve=e,f.reject=n})),d={id:l,resolver:f,ctx:r,timedout:!1},c._tasks[l]=d,c._requestTaskId=l,e.next=24,wn(c,On,Hn).call(c,n,t,r,d);case 24:return c._cbToGetTaskId=t,u&&(d.tmid=setTimeout((function(){bn.debug("ws request time out."),d.timedout=!0,d.resolver.reject("request timed out.")}),u)),c.disposed||c._ws.send(n),bn.debug("end to send task "+l),n=null,e.abrupt("return",f.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),l&&delete c._tasks[l],!(e.t0 instanceof Ue)){e.next=39;break}throw e.t0;case 39:throw new Ue(e.t0.message);case 40:return e.prev=40,n=null,e.finish(40);case 43:case"end":return e.stop()}}),e,this,[[1,32,40,43]])})))).apply(this,arguments)}function Xn(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return zn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zn(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t["return"]||t["return"]()}finally{if(s)throw o}}}}function zn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Yn(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function Jn(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var qn=new WeakSet,Qn=new WeakSet,Zn=function(){function e(){u(this,e),Yn(this,Qn),Yn(this,qn),Ce(this,"_maxWebSocketCon",10),Ce(this,"_wsClients",[])}return d(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e){return e.useWS?Jn(this,Qn,et).call(this,e):new gn(e)}},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function $n(e){this.removeTerminatedWSClient();var n,t,r,i=Xn(this._wsClients);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(t=o.serverInfo,r=e,(null==t?void 0:t.port)==(null==r?void 0:r.port)&&(null==t?void 0:t.protocol)==(null==r?void 0:r.protocol)&&(null==t?void 0:t.server)==(null==r?void 0:r.server)&&(null==t?void 0:t.ssl)==(null==r?void 0:r.ssl)&&(null==t?void 0:t.useWS)==(null==r?void 0:r.useWS)&&!o.disposed)return o.addRef(),o}}catch(a){i.e(a)}finally{i.f()}return null}function et(e){var n=Jn(this,qn,$n).call(this,e);return n||(this._wsClients.length<this._maxWebSocketCon?((n=new Rn(e)).addEvent("disposed","1",(function(){Zn.Instance.removeTerminatedWSClient()})),this._wsClients.push(n),n):null)}Ce(Zn,"_gClientPool",null);var nt=function(){function e(){u(this,e)}return d(e,null,[{key:"getHttpClientForDcp",value:function(n,t){var r,i=T.dcp,o=g.detect.ssl;if(t||!T.navInfoSync.bSSL?(r=i.Port,o=!1):(r=i.SSLPort,o=!0),n){var a=new Ve;return g.startsWith(n,"https://")?(a.ssl=!0,a.server=n.substring(8)):g.startsWith(n,"http://")?(a.ssl=!1,a.server=n.substring(7)):(a.ssl=g.detect.ssl,a.server=n),Zn.Instance.getClient(a)}return e.getHttpClient(null,r,o)}},{key:"getHttpClient",value:function(e,n,t){var r=t?"https":"http",i=new Ve(e||h(),n,t,!1,r);return Zn.Instance.getClient(i)}},{key:"getWsClient",value:function(e,n,t){var r=new Ve(e||h(),n,t,!0,T.dcp.wsProtocol);return Zn.Instance.getClient(r)}}]),e}();g.ClientPool=Zn;var tt=g.isString,rt=g.isArray,it=g.each;function ot(e,n){if(tt(n))e.push('"'),e.push(n),e.push('"');else if(rt(n)){var t=m;e.push("["),it(n,(function(n){t?t=I:e.push(","),ot(e,n)})),e.push("]")}else n===undefined?e.push('""'):e.push(n)}function at(){for(var e=[],n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];if(t.length>0)if(1===t.length){var i=t[0];e.push("["),ot(e,i),e.push("]")}else if(2===t.length){var o=t[0],a=t[1];e.push("["),ot(e,o),e.push(","),ot(e,a),e.push("]")}else ot(e,Array.prototype.slice.call(t));return e.join("")}function st(e){if(e===undefined)return-1;if(e.length<4)return-1;var n=e.lastIndexOf(".");if(-1===n)return-1;var t=e.slice(n).toLowerCase();return".bmp"===t||".dib"===t?T.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===t||".jpe"===t||".jpeg"===t||".jfif"===t?T.DWT.EnumDWT_ImageType.IT_JPG:".tif"===t||".tiff"===t?T.DWT.EnumDWT_ImageType.IT_TIF:".png"===t?T.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===t?T.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===t||".j2k"===t||".j2c"===t?T.DWT.EnumDWT_ImageType.IT_J2K:-1}var ut=d((function ai(){u(this,ai)})),ct=d((function si(){u(this,si)}));var lt={notSupportProperty:function(e){},notSupportMethod:function(e){},cformat:function(e,n){if(g.isString(e)){var t,r,i,o,a,s=e.indexOf("<%");if(-1==s)return e;if(r=e.substring(0,s),!(s+2<(t=e.indexOf(">",r))))return e;i=e.substring(s+1,t),o=e.substring(t+1);try{a=g.sprintf(i,n)}catch(u){a=""}return[r,a,o].join("")}return""},refreshImageAfterInvokeFun:function(e,n,t){return 1==t},loadHttpBlob:function(e,n,t,r,i,o,a,s){var u,c,l=I;if(c={method:n,dataType:"blob"},s&&(c.headers=s),""!=e.HTTPUserName&&(c.username=e.HTTPUserName,c.password=e.HTTPPassword),r){if((T.Lib.env.bMobile||T.navInfoSync.bChrome||T.navInfoSync.bFirefox)&&"get"==n)return c.fetchRaw=!0,fetch(t,c).then((function(e){var n;if(!e.ok)throw{httpCode:e.status,errorString:e.statusText};var t=e.headers.get("Content-Length"),r=0,i=null==e||null===(n=e.body)||void 0===n?void 0:n.getReader(),o=new ReadableStream({start:function(e){setTimeout((function n(){null==i||i.read().then((function(i){i.done?e.close():(r+=i.value.length,a({loaded:r,total:t}),e.enqueue(i.value),setTimeout(n,0))}))}),0)}}),s=e.headers.get("Content-Type");return s&&""!=s||(s="application/octet-stream"),new Response(o,{headers:{"Content-Type":s}})})).then((function(e){return e.blob()})).then((function(e){i(e),e=null}),(function(n){n&&n.httpCode?g.Errors.HttpDownloadError(e,!1,n.errorString,n.httpCode):g.Errors.HttpDownloadUrlError(e),g.isFunction(o)&&o({code:e._errorCode,message:e._getErrorString()})})),!0;c.onSuccess=i,g.isFunction(a)&&(c.beforeSend=function(e){e.addEventListener("progress",(function(e){!T.navInfoSync.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),I)}),l=m}else T.navInfoSync.bIE?(c.dataType="arraybuffer",c.onSuccess=function(n,t,r){var o,a;(o=n||r.responseData)&&(a=new Uint8Array(o)),e._errorCode=0,e._errorString="",i(a),a=null,l=m}):(c.dataType="text",c.contentType="text/plain; charset=x-user-defined",c.mimeType="text/plain; charset=x-user-defined",c.onSuccess=function(n,t,r){var o,a,s;a=(o=r.responseText).length,s=new Uint8Array(a);for(var u=0;u<a;u++)s[u]=o.charCodeAt(u);e._errorCode=0,e._errorString="",i(s),s=null,l=m}),c.headers?g.mix(c.headers,{"X-Requested-With":I}):c.headers={"X-Requested-With":I};if("post"==n){var f,d=e.httpFormFields;if(d)try{f=new FormData,g.each(d,(function(e,n){if(e instanceof Blob){var t=e.name;f.append(n,e,t)}else f.append(n,e)})),g.mix(c,{data:f,processData:I,contentType:I})}catch(_){}}u=function(n,t,r){var i,a;if(n&&g.isArray(n)&&n.length>2?(i=n[1],a=n[2]):(i=t,a=r),2==a.state&&0==a.status)if("abort"===a.statusText){g.Errors.HttpDownloadError(e,true)}else g.Errors.HttpDownloadUrlError(e);else g.Errors.HttpDownloadError(e,I,i,a.status);g.isFunction(o)&&o()},c.url=t,c.async=r,c.onError=u,c.onComplete=function(){g.bio=I};var p=g.ajax(c);return r&&(g.bio=p),l},combineUrl:function(e,n,t){var r=[],i=n;return i===undefined||t===undefined?undefined:(g.isString(i)||(i=String(n)),0==i.indexOf("http://")?(i=i.replace("http://",""),r.push("http://")):0==i.indexOf("https://")?(i=i.replace("https://",""),r.push("https://")):(0==i.indexOf("//")&&(i=i.replace("//","")),e.IfSSL?r.push("https://"):r.push("http://")),r.push(i),i.indexOf(":")<0&&(""==e.HTTPPort&&(e.HTTPPort=g.detect.ssl?443:80),(!g.detect.ssl&&80!=e.HTTPPort||g.detect.ssl&&443!=e.HTTPPort)&&(r.push(":"),r.push(e.HTTPPort))),0!==t.indexOf("/")&&r.push("/"),r.push(t),r.join(""))},httpPostUpload:function(e,n,t,r,i,o,a,s,u,c,l,f){if(!t||t.size<=0)return g.Errors.UploadFileCannotEmpty(e),g.isFunction(f)&&f(),I;var d,T,p=e.MaxUploadImageSize,_=t.size,h=t.type;if(_>p&&-1!=p)return g.Errors.UploadExceededMaxSize(e),g.isFunction(f)&&f(),I;if(""===h||h&&h!=e.HttpContentTypeFieldValue){var S=t.slice||t.webkitSlice||t.mozSlice,m=t.name;g.isString(m)&&""!=m||(m=t.fileName),(d=S.call(t,0,_,e.HttpContentTypeFieldValue)).name=m}else d=t;return t=null,d.remoteFilename=e.__remoteFilename,T=this.httpUploadByBIO(e,n,d,i,r,o,a,s,u,c,l,f),d=null,T},httpPostUploadFiles:function(e,n,t,r,i,o,a,s,u,c,l){var f,d,T=e.MaxUploadImageSize,p=0;if(!t||!g.isArray(t)||t.length<=0)return g.Errors.UploadFileCannotEmpty(e),g.isFunction(l)&&l(),I;for(f=0;f<t.length;f++){var _=t[f];if(!_||_.size<=0)return g.Errors.UploadFileCannotEmpty(e),g.isFunction(l)&&l(),I;var h=_.size,S=_.type;if(p+=h,""===S||S&&S!=e.HttpContentTypeFieldValue){var m=_.slice||_.webkitSlice||_.mozSlice,E=_.name,v=m.call(_,0,h,e.HttpContentTypeFieldValue);g.isString(E)&&""!=E||(E=_.fileName),v.name=this.cformat(E,f+1),t[f]=v}t[f].remoteFilename=this.cformat(e.__remoteFilename,f+1),_=null}if(p>T&&-1!=T)return g.Errors.UploadExceededMaxSize(e),g.isFunction(l)&&l(),I;for(d=this.httpUploadByBIO(e,n,t,i,r,o,a,s,u,!1,c,l),f=0;f<t.length;f++)t[f]=null;return t=null,d},httpPostUploadString:function(e,n,t,r,i,o,a,s,u,c,l){var f,d,T;if(""==t)return g.Errors.UploadFileCannotEmpty(e),g.isFunction(l)&&l(),I;if(d=e.MaxUploadImageSize,t.length>d&&-1!=d)return g.Errors.UploadExceededMaxSize(e),g.isFunction(l)&&l(),I;(f=new Blob([t],{type:"text/plain"})).name=r;return T=this.httpUploadByBIO(e,n,f,i,m,o,a,s,u,!1,c,l),f=null,T},httpUploadByBIO:function(e,n,t,r,i,o,a,s,u,c,l,f){var d,p,_,h;if(_=e.httpFormFields,h=new FormData,g.each(_,(function(e,n){if(e instanceof Blob){var t=e.name;h.append(n,e,t)}else h.append(n,e)})),g.bio=new g.BIO({action:n,data:h,async:i,retry:s,bOnlyEmptyIsOK:u}),(d=g.bio.get("uploadType"))&&((p=d.get("ajaxConfig"))&&p.headers&&o&&g.mix(p.headers,o),r>=0&&d.set("blockSize",r),e.__withCredentials&&g.mix(p.xhrFields,{withCredentials:!0})),e.__HTTPPostResponseString=I,g.bio.on(g.BIO.event.SUCCESS,(function(n){if(g.bio=I,n&&g.isString(n.response)?e.__HTTPPostResponseString=n.response:e.__HTTPPostResponseString="",g.isFunction(e.__OnHttpUploadStatus)){var t;t={fileName:n.name,percentage:100,statusCode:200,responseString:e.__HTTPPostResponseString},e.__OnHttpUploadStatus(t)}g.isFunction(l)&&l(e.__HTTPPostResponseString)})),g.bio.on(g.BIO.event.ERROR,(function(n){var t=n&&n.canceled;n&&n.timeout;var r,i=I,o=0;(g.bio=I,n&&g.isString(n.response)?e.__HTTPPostResponseString=n.response:e.__HTTPPostResponseString="",t||(n&&n.msg&&(i=n.msg),n&&n.httpStatus&&(o=n.httpStatus)),g.Errors.UploadError(e,t,i,o),g.isFunction(e.__OnHttpUploadStatus))&&(r={fileName:n.name,percentage:100,statusCode:o,responseString:e.__HTTPPostResponseString},e.__OnHttpUploadStatus(r));g.isFunction(f)&&f(e.__HTTPPostResponseString)})),(a||g.isFunction(e.__OnHttpUploadStatus))&&(g.bio.on(g.BIO.event.PROGRESS,(function(n){!T.navInfoSync.bSafari&&n&&(delete n.totalSize,delete n.position);var t=0===n.total?100:Math.round(100*n.loaded/n.total);if([n.loaded," / ",n.total].join(""),g.isFunction(e.__OnHttpUploadStatus)){var r;t>99&&(t=99),r={fileName:n.name,percentage:t,statusCode:0,responseString:""},e.__OnHttpUploadStatus(r)}a&&e._OnPercentDone([0,t,"","http",n.name])})),a&&e._OnPercentDone([0,-1,T.MSG.Uploading,"http"]),g.isFunction(e.__OnHttpUploadStatus))){var S="";g.isArray(t)&&t.length>0||(t&&t.name&&""!=t.name?S=t.name:t&&t.fileName&&(S=t.fileName)),e.__OnHttpUploadStatus({fileName:S,percentage:0,statusCode:0,responseString:""})}return c&&c.bCancel?(c.st=2,g.isFunction(f)&&f(!1),!1):g.bio.upload(t)},httpPutImage:function(e,n,t,r,i,o,a){var s=m,u={method:"PUT",url:n,hasContent:m,processData:I,async:r,data:t,onSuccess:i,onError:function(){s=I,g.isFunction(o)&&o()},onComplete:function(){g.bio=I},beforeSend:function(e){g.isFunction(a)&&e.upload.addEventListener("progress",(function(e){!T.navInfoSync.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),I)}};return""!=e.HTTPUserName&&(u.username=e.HTTPUserName,u.password=e.HTTPPassword),r||g.mix(u,{headers:{"X-Requested-With":I}}),g.bio=g.ajax(u),s},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],handleOnBitmapChangedEvent:function(e,n,t){var r="_OnBitmapChanged";return g.isFunction(e[r])&&e[r](n.result,n,t),I},addImageFileExt:function(e,n){var t,r=e.substring(e.lastIndexOf(".")).toLowerCase();return".bmp"==r||".dib"==r||".jpg"==r||".jpe"==r||".jpeg"==r||".jfif"==r||".tif"==r||".tiff"==r||".png"==r||".pdf"==r?e:(n==T.DWT.EnumDWT_ImageType.IT_BMP?t=[e,".bmp"].join(""):n==T.DWT.EnumDWT_ImageType.IT_JPG?t=[e,".jpg"].join(""):n==T.DWT.EnumDWT_ImageType.IT_PNG?t=[e,".png"].join(""):n==T.DWT.EnumDWT_ImageType.IT_TIF?t=[e,".tif"].join(""):n==T.DWT.EnumDWT_ImageType.IT_PDF?t=[e,".pdf"].join(""):n==T.DWT.EnumDWT_ImageType.IT_J2K&&(t=[e,".jp2"].join("")),t)},GetImageInfo:function(e,n){var t=e._ImgManager.convertClientIndexToServerId(n);return-1==t?(g.Errors.IndexOutOfRange(e),!1):e._innerFun("GetImageInfo",at(t))},getBlobTypeByImageType:function(e){var n="application/octet-stream";switch(e){case 0:n="image/bmp";break;case 1:n="image/jpeg";break;case 2:n="image/tiff";break;case 3:n="image/png";break;case 4:n="application/pdf";break;case 14:n="image/jp2"}return n},callbacks:[],pushCallback:function(e,n,t){var r={method:e,callback:n,ticks:t};lt.callbacks.push(r)},refreshUIRef:0,isServerInvalid:function(e){var n=e,t=!1,r=!1;return(e._isTwainServiceType()||e._isWasmWithScan())&&(t=!n._bReady||null===n._wsClient,r=n.__bMustUpgradeService),t?g.Errors.Server_Invalid(n):r?g.Errors.MustUpgradeService(n):n._destroy&&g.Errors.Destroyed(n),t||r||-2208==n._errorCode||n._destroy},replaceLocalFilename:function(e){var n;return e===undefined?"":(n=(e=String(e)).replace(/\\/g,"\\\\"),T.navInfoSync.bFileSystem&&(n=decodeURI(n)),n)},getImageType:st,makeParams:at,showMask:function(e,n,t){if(g.log("showMask:"+e+"--"+ft),0==ft)if(n){g.detect.showMask(n);var r=g.mask.dlgMask;if(r){r.style.zIndex="9990";var i=g.one(".dynamsoft-backdrop",r.parentNode);i&&i.length>0&&(i[0].style.zIndex="9990")}}else g.detect.showMask(t||{});ft++},hideMask:function(e){g.log("hideMask:"+e+"--"+ft),ft>1?ft--:ft<=1&&(g.detect.hideMask(),ft=0)}};g.html5.Funs=lt;var ft=0;function dt(e){if(e.ProductName){var n=e.ProductName;e.ProductName=g.base64.decode(n)}if(e.ProductFamily){var t=e.ProductFamily;e.ProductFamily=g.base64.decode(t)}if(e.Manufacturer){var r=e.Manufacturer;e.Manufacturer=g.base64.decode(r)}if(e.Version&&e.Version.Info){var i=e.Version.Info;e.Version.Info=g.base64.decode(i)}}function Tt(e){var n=new ut;return e.deviceInfo&&(n.deviceInfo=g.clone(e.deviceInfo)),e.deviceType&&(n.deviceType=g.clone(e.deviceType)),e.displayName&&(n.displayName=g.clone(e.displayName)),e.name&&(n.name=g.clone(e.name)),e.serviceInfo&&(n.serviceInfo=function(e){var n=new ct;return n.server=e.server,e.attrs&&(n.attrs=g.clone(e.attrs)),n}(e.serviceInfo)),n}function gt(e,n){var t,r=e.name,i="",o=e.deviceType;t=o==ae?"":o==ue?"Twain64-":o==se?"":o==ce?"ICA-":o==le?"Sane-":"",n&&n.attrs&&n.attrs.ty&&(i=" on ["+n.attrs.ty+"]"),e.displayName=[t,r,i].join("")}g.removeNonPrintableChar;var pt=1;var _t=function(){function e(n,t){u(this,e),Ce(this,"m_server",""),Ce(this,"m_iUsingTime",0),Ce(this,"m_countMap",{}),Ce(this,"m_newConsum",!1),Ce(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=n,n==T.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=t):n!=T.DWT.EnumInstance.dwt_browser&&n!=T.DWT.EnumInstance.dbr||(this.m_deploymentType="browser",this.m_server="")}return d(e,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=g.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=g.nil,this.m_maxExpiredTime=g.nil,this.m_cu=g.nil,this.m_ar=g.nil,this.m_ltsInstance=g.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),e}();var ht=T.DWT;ht.LTS=ht.LTS||{},ht.licenseException={code:0,message:"",fromLTS:!1},ht.bLTSOnline=!0,ht.axInstance=undefined,ht.lOnUpdateDWObj=[],ht.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var St,It,mt,Et,vt=0,wt={},Wt=!1,bt=!1,Pt={},Ct=!1,At=!1,yt=!1;function Dt(){var e=g.product.handshakeCode;return g.isString(e)||(e=""),e}function Ot(){var e=g.product.organizationID;return g.isNumber(e)?e=""+e:g.isString(e)||(e=""),e}function Lt(){return g.replaceAll(ht.JSVersion,",",".")}function Rt(e,n){var t=e;return t===g.nil&&(t=g.IsNeedLoadWasm()?ht.EnumInstance.dwt_browser:ht.EnumInstance.dwt_desktop),t==ht.EnumInstance.dwt_browser?(It||(It=new _t(t,"")),It):t==ht.EnumInstance.dbr?(Et||(Et=new _t(t,"")),Et):(mt||(mt=new _t(t,"")),mt)}ht.lupverfy=function(){Rt(ht.EnumInstance.dwt_desktop).get_ltsInstance(Gt),Rt(ht.EnumInstance.dwt_browser).get_ltsInstance(Gt),Rt(ht.EnumInstance.dbr).get_ltsInstance(Gt)},ht.lsmid=function(e,n){Rt(ht.EnumInstance.dwt_desktop).set_cu(e)},ht.lsar=function(e,n){Rt(ht.EnumInstance.dwt_desktop).set_ar(e)},ht.lsmid2b=function(e){Rt(ht.EnumInstance.dwt_browser).set_cu(e)},ht.lgar=function(e,n){Rt(e).get_ar()},ht.laddDWTObj=function(e){var n=!1;g.each(ht.lOnUpdateDWObj,(function(t){if(t==e)return n=!0,!1})),n||ht.lOnUpdateDWObj.push(e)},ht.lremoveDWTObj=function(e){g.each(ht.lOnUpdateDWObj,(function(n,t){if(n==e)return ht.lOnUpdateDWObj.splice(t,1),!1}))},ht.lsendUpdateEvt=function(e,n){var t=[];if(g.each(ht.lOnUpdateDWObj,(function(n){e==ht.EnumInstance.dwt_desktop?(n._bAx||n._isTwainServiceType()||n._isDMServiceType())&&t.push(n):e==ht.EnumInstance.dwt_browser&&(n._bAx||n._isTwainServiceType()||n._isDMServiceType()||t.push(n))})),0==t.length)return g.Promise.resolve();var r,i=t[0];return i._bAx?(g.each(t,(function(n){n.SetLTSInfo(Rt(e).get_ar(),Rt(e).get_cu())})),i.GetLicenseInfo().then((function(t){t&&g.isArray(t.Detail)&&t.Detail.length>0&&ht.lsexp(e,t.Detail[0].ExpireDate,n)}))):(r=i.SetLTSLicenseAsync(Rt(e).get_ar()).then((function(t){t&&g.isArray(t.Detail)&&t.Detail.length>0&&ht.lsexp(e,t.Detail[0].ExpireDate,n)})),g.each(t,(function(n,t){0!=t&&n.SetLTSLicenseAsync(Rt(e).get_ar())})),r)},ht.lgcb=function(){var e=T.navInfoSync,n=[];return e.bChrome?n.push("Chrome"):e.bFirefox?n.push("Firefox"):e.bEdge?n.push("Edge"):e.bIE?n.push("IE"):e.bSafari?n.push("Safari"):e.bOpera?n.push("Opera"):e.b360SE?n.push("360SE"):e.bTencentTraveler?n.push("TencentTraveler"):e.bMaxthon?n.push("Maxthon"):e.bMetaSr?n.push("MetaSr"):e.bTheWorld?n.push("TheWorld"):e.bUC?n.push("UC"):e.bHuaWeiBrowser&&n.push("HuaWeiBrowser"),n.push(e.strBrowserVersion),e.bWin?n.push("Windows"):e.bMac?n.push("Mac"):e.bLinux?n.push("Linux"):e.bAndroid?n.push("Android"):e.bChromeOS?n.push("ChromeOS"):e.bHarmonyOS?n.push("HarmonyOS"):g.env.bMobile?n.push("Mobile OS"):T.navInfo.bEmbed&&n.push("Embed OS"),n.join(" ")};var Ft=-2440,Nt=-2441,kt=-2443,xt=-2445,Mt=-2446,Bt=-2447;function Gt(e){var n,t,r=g.product.licenseServer;if(r&&r.length>0)for(n=0;n<r.length;n++)t=r[n],g.endsWith(t,"/")||(r[n]=t+"/");var i={dm:location.origin?g.startsWith(location.origin,"http")?location.origin:"https://localhost":g.startsWith(location.href,"http")?location.href:"https://localhost",lf:g.localforage,btoa:g.btoa,atob:g.atob,sutlcb:function(){g.isFunction(ht.lonsend)&&ht.lonsend()},fol:ht.OnFirstOffline,dwt:!0};if(e==ht.EnumInstance.dwt_browser||e==ht.EnumInstance.dbr?i.feab=ht.lfeab_wasm:i.feab=ht.lfeab_ax,!T.navInfoSync.bIE&&g.product.ltsDebug&&(i.debugLog=console.log),T.LTS&&T.LTS._)return T.LTS._.createLtsInstance(i);var o={},a=function(){return g.Promise.reject({code:Mt,message:"The dynamsoft.lts.js load failed."})};return o.i=a,o.s=a,o.caret=a,o}function Ut(e,n){var t=null!=n?n:"",r=Rt(e),i=r.get_enumDeploymentType();if(ht.lclex(),r.get_ar()&&r.get_cu())return Promise.resolve({ar:r.get_ar(),cu:r.get_cu()});var o={pd:ht.lgpd(e),v:Lt(),os:ht.lgcb(),fn:ht.DeviceFriendlyName||"",ls:g.product.licenseServer,sp:g.product.sessionPassword,l:g.License.getLTSLicense(),mnet:function(){return r.get_maxExpiredTime()},mxet:function(){return r.get_minExpiredTime()},fol:ht.OnFirstOffline};return o.dt=r.get_deploymentType(),i==ht.EnumInstance.dwt_desktop?o.lsu=r.get_cu():i==ht.EnumInstance.dbr||(o.dwt=!0,""!=r.get_cu()&&(o.lsu=r.get_cu()),o.updateLicense=function(e){r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),ht.lsendUpdateEvt(i,t)}),r.get_ltsInstance(Gt).i(o).then((function(e){return r.get_ar()||r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),e}))}function Ht(){return Date.now()}function jt(e){var n=e?new Date(e):new Date,t="yyyy-MM-ddTHH:mm:ss.SSSZ",r={"M+":n.getUTCMonth()+1,"d+":n.getUTCDate(),"H+":n.getUTCHours(),"h+":n.getUTCHours()%12||12,"m+":n.getUTCMinutes(),"s+":n.getUTCSeconds(),"q+":Math.floor((n.getUTCMonth()+3)/3),"S+":n.getUTCMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return t}function Vt(e,n,t,r){return Kt.apply(this,arguments)}function Kt(){return(Kt=n(o.mark((function e(n,t,r,i){var a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!=Ze){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(t!=en){e.next=8;break}return e.abrupt("return",g.parse(n));case 8:if(t!=nn){e.next=13;break}if(!i||!i.client){e.next=11;break}return e.abrupt("return",i.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(t!=rn){e.next=20;break}if(a=null==i?void 0:i.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return n.indexOf("Version not found")>=0?g.isFunction(a.fFun)&&a.fFun():g.isFunction(a.sFun)&&a.sFun(),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xt(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function zt(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}ht.lgpd=function(e){return T.navInfoSync.bWin&&e==ht.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},ht.lglic=Ut,ht.lgbuuid=function(){return Rt(ht.EnumInstance.dwt_browser).get_ltsInstance(Gt).u()},ht.lshow=function(){return{t:St,t2:vt,m:JSON.stringify(wt)}},ht.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},ht.lcvrf=function(e){e&&setTimeout((function(){ht.lcvrf_(e)}),1)},ht.lcvrf_=function(e){var n;n=e._bAx?ht.EnumInstance.dwt_desktop:e._isMobileMode()?ht.EnumInstance.dwt_browser:ht.EnumInstance.dwt_desktop;var t,r=ht.DeviceFriendlyName||"",i=ht.lgcb(),o=Rt(n),a={hs:Dt(),og:Ot(),cu:o.get_cu(),fn:r,cw:"",os:i,v:Lt(),dt:o.get_deploymentType(),ed:"js"},s=function(e,n){var t,r,i=T.Lib,o=0;if(i.isString(e)&&""!=e&&"{}"!=e&&n&&i.isArray(n)&&!(n.length<1)){if(r=Rt(n[0]),t=i.parse(e),ht.lclex(),0==vt){var a=Ht(),s="";vt=a,St=jt(a),wt={},o=0,i.each(t,(function(e,n){(n<o||0==o)&&(o=n,s=e)})),o>0&&r.get_ltsInstance(Gt).s(i.product.licenseServer,s,o,!0).then((function(){}),(function(e){}))}i.each(t,(function(e,n){var t=!1,a=parseInt(n);a>0&&a!=o&&(a+18e4<Ht()&&(t=!0),r.get_ltsInstance(Gt).s(i.product.licenseServer,e,n,t).then((function(){}),(function(e){})))}))}};if(a.pd=ht.lgpd(n),t=JSON.stringify(a),!e._bAx){var u="GetBuffer",c=at(g.replaceAll(t,'"','\\"')),l={cmd:u,cmdId:(++pt).toString(),sFun:s,fFun:function(){},params:[n]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(t),[n,""])},ht.lavrf=function(e,n,t,r){var i=1;if(""!=e){n>1&&(i=n);var o=Ht();if(vt>0&&vt+18e4<o){bt?(wt={},ht.lavrf__unload()):ht.lavrf__(!0,t,r);var a=Ht()+1;vt=a,St=jt(a),wt={}}Wt=!0,bt=!1,wt[e]?wt[e]+=i:wt[e]=i,0==vt&&ht.lavrf__(!0,t,r)}},ht.lavrf_=function(e,n,t){if(Wt){var r=1;e&&(r=e),setTimeout((function(){ht.lavrf__(!1,n,t)}),r)}},ht.lavrf__=function(e,n,t){var r,i,o,a=Ht(),s=!1,u=!!e,c=0,l=n;g.isUndefined(l)&&(l=ht.EnumInstance.dwt_browser),o=Rt(l),Wt=!1,0==vt&&(s=!0,vt=a,St=jt(a)),r=vt,i=St;var f={};f.ut=i;var d={};if(g.each(wt,(function(e,n){d[n]=e,e>0&&c++})),f.cts=d,u||r+18e4<a){u=!0;var T=Ht()+1;if(vt=T,St=jt(T),wt={},bt=!1,0==c)return}else{if(0==c)return;bt=!0}f.dur=s?1:180;var p,_=ht.DeviceFriendlyName||"",h=ht.lgcb(),S={hs:Dt(),og:Ot(),cu:o.get_cu(),fn:_,cw:"",os:h,v:Lt(),dt:o.get_deploymentType(),ed:"js",rcs:[f]};S.product=ht.lgpd(n),p=JSON.stringify(S),g.product.ltsDebug&&jt(),ht.lclex(),o.get_ltsInstance(Gt).s(g.product.licenseServer,p,""+r,u).then((function(){}),(function(e){}))},ht.lavrf__unload=function(){var e,n=Ht(),t=!0,r=!1,i=Rt(ht.EnumInstance.dwt_desktop),o=Rt(ht.EnumInstance.dwt_browser),a=Rt(ht.EnumInstance.dbr);Wt=!1,0==vt&&(vt=n,St=jt(n)),e=vt;var s=Ht()+1;vt=s,St=jt(s),wt={},bt=!1,e+=1,ht.lclex(),i.inited_ltsInstance()&&i.get_ltsInstance(Gt).s(g.product.licenseServer,r,""+e,t).then((function(){}),(function(e){})),o.inited_ltsInstance()&&o.get_ltsInstance(Gt).s(g.product.licenseServer,r,""+e,t).then((function(){}),(function(e){})),a.inited_ltsInstance()&&a.get_ltsInstance(Gt).s(g.product.licenseServer,r,""+e,t).then((function(){}),(function(e){}));var u,c=Object.keys(Pt);g.each(c,(function(n){(u=Pt[n]).inited_ltsInstance()&&u.get_ltsInstance(Gt).s(g.product.licenseServer,r,""+e,t).then((function(){}),(function(e){}))}))},ht.lclex=function(){var e=ht.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},ht.li=function(e,n){var t;if(e.axInstance&&(ht.axInstance=e.axInstance,ht.axInstance))return t=ht.axInstance.GetUUID(),g.product.ltsDebug&&g.log("ActiveX cu: "+t),Rt(e.instanceMode).set_cu(t),t;return Rt(e.instanceMode).get_cu()},ht.lfeab_ax=function(e){return new g.Promise((function(n,t){var r="";if(ht.axInstance)try{r=ht.axInstance.Encrypt(e,0)}catch(i){}n(r)}))},ht.lfeab_wasm=function(e){return new g.Promise((function(n,t){var r=new T.Imagecore;r.getAesResult(e).then((function(e){r.terminate(),n(e)}),(function(e){r.terminate(),t(e)}))}))},ht.lwsproc=function(e,n){try{e=g.parse(e)}catch(t){return void(n.fFun&&n.fFun(t))}"GetBuffer"==e.method?n.sFun&&e.result.length>0?n.sFun(e.result[0],n.params):n.sFun("",n.params):n.sFun&&n.sFun(e)},ht.lsexp=function(e,n,t){var r,i=n;if(3==(r=(i=g.replaceAll(i,"/","-")).split("-")).length){var o=r[0],a=r[1],s=r[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),i=[o,a,s].join("-")}var u=[i,"T23:59:59.999Z"].join("");Rt(e).set_minExpiredTime(u),Rt(e).set_maxExpiredTime(u)},ht.lunload=function(){ht.lavrf__unload();var e=Rt(ht.EnumInstance.dwt_desktop),n=Rt(ht.EnumInstance.dwt_browser),t=Rt(ht.EnumInstance.dbr);e.clearData(),n.clearData(),t.clearData();var r=Object.keys(Pt);g.each(r,(function(e){Pt[e].clearData()})),vt=0,St=g.nil,wt={},bt=!1,Wt=!1,Ct=!1,At=!1,yt=!1,ht.lclex(),ht.bLTSOnline=!0,ht.axInstance=g.nil,ht.lOnUpdateDWObj=[]},ht.lcexp=function(e,n){return Rt(e).get_ltsInstance(Gt).caret().then((function(){return!1}),(function(e){var n=ht.licenseException,t="";return e instanceof Error||"message"in e?t=e.message:g.isString(e)&&(t=e),ht.lsetException(xt,t,!1),At||(At=!0,g.error(t),T.OnLTSLicenseError&&T.OnLTSLicenseError(g.License.getPublicLicenseContent(n.message))),!0}))},ht.OnLicenseException=function(){var e=ht.licenseException,n=e.message;if(g.isString(n)&&(n.indexOf("Error Code")>-1?n=g.replaceAll(n,"Error Code","error code"):n.indexOf("Error code")>-1&&(n=g.replaceAll(n,"Error code","error code"))),n.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(n=n.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=n),n.indexOf("error code:")>-1){var t=n.substr(0,n.indexOf("message")),r=n.substr(n.indexOf("message"));t.indexOf("{")>-1&&(t=t.substr(t.indexOf("{")+1)),r.indexOf("}")>-1&&(r=r.substr(0,r.indexOf("}"))),t=g.replaceAll(t,"error code:",""),r=g.replaceAll(r,"message: ",""),ht.lsetException(parseInt(t),r,!0),g.error(r),T.OnLTSLicenseError&&T.OnLTSLicenseError(g.License.getPublicLicenseContent(n))}else{if(!e.code){var i=Ft;n.indexOf("timed out")>-1||n.indexOf("timeout")>-1?i=Nt:(n.indexOf("access-control-allow-origin")>-1||n.indexOf("cors")>-1)&&(i=kt),ht.lsetException(i,n,!0)}if(g.error(e.message),e.code==Mt)return;T.OnLTSLicenseError&&T.OnLTSLicenseError(g.License.getPublicLicenseContent(e.message))}},ht.lol=function(){return ht.bLTSOnline},ht.OnFirstOffline=function(e){ht.bLTSOnline=!1},ht.lpubdlg=function(e,n){if(g.isString(e)&&""!=e){if(e=g.atob(e),console&&console.warn,1==n)return Ct||(Ct=!0,T.OnLTSPublicLicenseMessage&&T.OnLTSPublicLicenseMessage(g.License.getPublicLicenseContent(e))),!0;2==n&&(Ct||(Ct=!0))}return!1},ht.lcheckLic=function(e,n,t){var r=!1;if(n){if(g.isArray(n.Detail)&&n.Detail.length>0){var i=n.Detail[0].ExpireDate;return ht.lsexp(e,i,t),ht.lcexp(e,t).then((function(e){var t=!1;e?t=!0:1!=n.Trial&&2!=n.Trial||(t=ht.lpubdlg(n.Message,n.Trial)),t||ht.bLTSOnline||yt||(yt=!0,T.OnLTSConnectionWarning&&T.OnLTSConnectionWarning())}))}1!=n.Trial&&2!=n.Trial||(r=ht.lpubdlg(n.Message,n.Trial))}r||ht.bLTSOnline||yt||(yt=!0,T.OnLTSConnectionWarning&&T.OnLTSConnectionWarning())},ht.lisValidID=function(e){if(g.isString(e)&&""!=e)return!0;var n,t=ht.licenseException;return ht.lsetException(Bt,"Failed to generate an ID for your device to license it: not enough permission.",!0),g.error(t.message),n=t.message,T.OnLTSUUIDError&&T.OnLTSUUIDError(n),!1},ht.lsetException=function(e,n,t){var r=ht.licenseException;r.code=e,r.message=n,g.isUndefined(t)||(r.fromLTS=t)},T.DWT.NeedCheckWebTwainBySocket=function(){return!(e=location.hostname,"localhost"==e||"127.0.0.1"==e||0==e.indexOf("192.168.")||0==e.indexOf("172.16.")||0==e.indexOf("10.")||T.navInfoSync.bSSL||!((T.navInfoSync.bChrome||T.navInfoSync.bEdge)&&parseInt(T.navInfoSync.strBrowserVersion)>=94));var e},T.DWT.CheckWebTwainBySocket=function(e,n,t){var r,i,o,a=T.Lib.detect.urls;if(a&&a.length>0){var s=a[0];r=s.host||h(),i=s.port,o=s.ssl}else r=h(),i=(o=T.navInfoSync.bSSL)?T.DWT.SSLPort:T.DWT.Port;var u=g.now(),c=nt.getWsClient(r,i,o);if(c.connected)return g.isFunction(e)&&e(),void c.dispose();var l,f={id:u,method:"VersionInfo",cmdId:u,version:[T.Lib.product.getDWTPrefix(),T.Lib.product.getServerVersionInfo()].join("")},d=Vt,p={cmdId:u,cmd:null,sFun:e,fFun:n},_=500;T.navInfoSync.bAndroid&&(_=1500),l={client:c,userData:p,taskId:u},c.setRetry(0),c.request(g.stringify(f),d,l,_).then((function(){c.dispose()}),(function(){g.isFunction(t)&&t(),c.dispose()}))},T.DWT.IsLocalServiceConnected=function(){return new g.Promise((function(e,n){var t,r=h();g.each(g.detect.ports,(function(e){T.navInfoSync.bSSL?e.ssl&&(t=e.port):e.ssl||(t=e.port)})),T.DWT.CheckConnectToTheService(r,t,(function(n,t,r){e(!0)}),(function(){n(!1)}))}))};var Yt=p+".",Jt=parseInt(p),qt=0,Qt=1,Zt=2,$t=3,er=4,nr=7,tr=8,rr=9,ir=10,or=50,ar=51,sr=52,ur=g.getLogger();function cr(e){return g.isString(e)?g.trim(e):e}var lr=new WeakSet,fr=new WeakSet,dr=new WeakSet,Tr=new WeakSet,gr=new WeakSet,pr=new WeakSet,_r=new WeakSet,hr=new WeakSet,Sr=new WeakSet,Ir=new WeakSet,mr=new WeakSet,Er=new WeakSet,vr=new WeakSet,wr=new WeakSet,Wr=function(){function e(){u(this,e),Xt(this,wr),Xt(this,vr),Xt(this,Er),Xt(this,mr),Xt(this,Ir),Xt(this,Sr),Xt(this,hr),Xt(this,_r),Xt(this,pr),Xt(this,gr),Xt(this,Tr),Xt(this,dr),Xt(this,fr),Xt(this,lr)}return d(e,[{key:"isLTS",value:function(){return g.isString(T.Lib.product.handshakeCode)||g.isString(T.Lib.product.organizationID)||T.Lib.product.bPublicLTS||g.isString(T.DWT.ProductKey)&&g.startsWith(T.DWT.ProductKey,"DLS2")}},{key:"isLongKey",value:function(e){if(!(g.isString(e)&&e.length>0))return!1;var n=e.charAt(0);return"f"==n||"t"==n}},{key:"isLicenseMixed",value:function(e,n){var t,r=!1,i=e||T.DWT.ProductKey;(T.DWT.lclex(),n)&&((cr(T.DWT.organizationID)||cr(T.DWT.handshakeCode))&&i&&(r=!0,t={},g.Errors.LongKeyShortKeyMixed(t)));if(!r&&g.isString(i))if(i=g.trim(i),g.startsWith(i,"f")||g.startsWith(i,"t"));else if(""==i);else if(g.startsWith(i,"DLS2"))try{zt(this,fr,Pr).call(this,i)}catch(a){r=!0,t={},g.Errors.LTSErrors(t),t._errorString=a.message}else{zt(this,lr,br).call(this,i).LTS||(r=!0,t={},g.Errors.FailedParseProductKey(t))}if(r&&t&&(T.Lib.Errors.SetLTSException(t),ur)){var o=T.DWT.licenseException;ur.error(o.message)}return r}},{key:"reparseProductKey",value:function(){var e=cr(T.DWT.organizationID),n=cr(T.DWT.handshakeCode),t=e||n,r=g.product,i=g.trim(T.DWT.ProductKey);if(!t){var o=zt(this,lr,br).call(this,i);o.LTS&&(n=cr(o.handshakeCode),t=(e=cr(o.organizationID))||n)}if(t)return this._innerResetLicense(),g.isNumber(i)&&(e=i),r.handshakeCode=n,r.organizationID=e,r.licenseServer=T.DWT.licenseServer,r.sessionPassword=T.DWT.sessionPassword,void(r.bPublicLTS=zt(this,dr,Cr).call(this,r.licenseServer,t));var a=!1;if(r.refProductKey!==i&&(this._innerResetLicense(),g.isString(i)&&i.length>0&&(r.refProductKey=i,a=!0)),a){var s=r.refProductKey.charAt(0);if("f"!=s&&"t"!=s){var u,c={_pLoad:{isEmpty:m},_license:r.refProductKey,_licenseServer:[]};try{u=S(c)}catch(f){g.error(f),u=!1}if(u&&g.isString(u.l)){var l=g.trim(u.l);""==l?r.organizationID=l:-1!=l.indexOf("-")?r.handshakeCode=l:r.organizationID=l,g.isArray(u.ls)&&u.ls.length>0&&(r.licenseServer=u.ls),r.bPublicLTS=zt(this,dr,Cr).call(this,r.licenseServer,l),r.sessionPassword=u.sp}else r.bPublicLTS=!1}else r.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){var e=T.Lib.product;e.refProductKey="",e.handshakeCode=undefined,e.organizationID=undefined,e.licenseServer=undefined,e.sessionPassword="",e.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,n,t){if(g.product.bHTML5Edition){if(e)return zt(this,wr,Mr).call(this,n);var r=t._bRemoteMode,i=t.__serverPlatform;return this.isOSOK(n,r,i)}return m}},{key:"checkLocalPlatformForRemoteService",value:function(e){var n,t,r,i=e.__licenseInfo,o=function(){var e=T.navInfoSync;return e.bAndroid?L:e.bMac?C:e.bChromeOS?D:e.bHarmonyOS?O:T.navInfo.bEmbed?y:e.bLinux?A:e.biPhone||e.biPad?R:P}(),a=!1;for(n=0;n<i.Detail.length;n++)if(t=i.Detail[n],(r=zt(this,Er,kr).call(this,t.EnumLicenseType,t.LicenseType)).AndroidW&&!T.navInfoSync.bAndroid&&(t.OS=g.replaceAll(t.OS,"Wasm","AndroidW")),r.Core&&g.isString(t.Version)&&0==t.Version.indexOf(Yt)){if(a=zt(this,wr,Mr).call(this,t.OS))break;if(a=this.isOSOK(t.OS,true,o))break}return a||(o==P?g.Errors.LicenseNotSupportWindows(e):o==A?g.Errors.LicenseNotSupportLinux(e):o==C?g.Errors.LicenseNotSupportMAC(e):g.Errors.LicenseNotSupportOS(e)),a}},{key:"checkProductKey",value:function(e,n,t,r){var i=T.DWT.licenseException,o=!1,a=I;return n.Camera?this.checkCameraProductKey(e):(g.isFunction(e._isMobileMode)&&e._isMobileMode()&&(a=m),(o=zt(this,gr,yr).call(this,e,e.__licenseInfo,a,n,t,r))&&n.Core&&g.isFunction(e._isWasmWithScan)&&e._isWasmWithScan()&&(o=this.checkAndroidServiceCore(e,t,r)),o||(i.code=e._errorCode,i.message=e._getErrorString(),i.fromLTS=!1),o)}},{key:"checkCameraProductKey",value:function(e){var n,t=T.DWT.licenseException,r=e.__calic;return(n=zt(this,gr,yr).call(this,e,r,true,{Camera:!0},!0,!1))||(t.code=e._errorCode,t.message=e._getErrorString(),t.fromLTS=!1),n}},{key:"checkAndroidServiceCore",value:function(e,n,t){var r=T.DWT.licenseException,i=!1;return g.isFunction(e._isWasmWithScan)&&e._isWasmWithScan()&&(i=zt(this,gr,yr).call(this,e,e.__anlic,!1,{Core:!0},n,t)),i||(r.code=e._errorCode,r.message=e._getErrorString(),r.fromLTS=!1),i}},{key:"showLicenseErrorDialog",value:function(e){var n=e.code;0!=n&&(n==zt(this,_r,Or).call(this)?zt(this,Ir,Fr).call(this):zt(this,pr,Dr).call(this,e))}},{key:"isBindDomainOK",value:function(e){if(g.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return m;var n=location.hostname,t=I;if(""==n)return m;for(var r=n.toLowerCase().split("."),i=r.length,o=e.toLowerCase().split(";"),a=0;a<o.length;a++){var s=o[a];if("*.*"==s){t=m;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=i){for(var l=m,f=c-1;f>0;f--){if(u[f].indexOf("*")>-1){t=m;break}if(f+i-c>=0){if(r[f+i-c]!=u[f]){l=I;break}}else if("*"!=u[f]){l=I;break}}if(l&&("*"==u[0]||i>=c&&r[i-c]==u[0])){t=m;break}}}return t}},{key:"isExpiredOrFuture",value:function(e,n){if(""==e)return I;if(!n){var t=e.length;if(t>2&&"/"==e[t-2]&&"0"==e[t-1])return I}var r=this.parseDateFromString(e),i=(new Date).getTime(),o=i+5184e6;return r.getTime()<i||n&&r.getTime()>o?m:I}},{key:"remainExpireDays",value:function(e){if(""==e)return 65536;var n=this.parseDateFromString(e),t=(new Date).getTime(),r=(n.getTime()-t)/864e5;return n.getTime()<t?0:Math.ceil(r)}},{key:"isOSOK",value:function(e,n,t){var r=!1,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1;if(""==e||"0"==e)return m;if(n)t==P?o=!0:t==A?i=!0:t==C?r=!0:t==y?s=!0:t==D?u=!0:t==L?c=!0:t==O?l=!0:t==R&&(a=!0);else{var f=T.navInfoSync;r=f.bMac,i=f.bLinux,o=f.bWin,a=f.biPhone||f.biPad,u=f.bChromeOS,s=T.navInfo.bEmbed,c=f.bAndroid,l=f.bHarmonyOS}return(e=e.toLowerCase()).indexOf("windows")>-1&&o||e.indexOf("mac")>-1&&r||e.indexOf("linux")>-1&&(i||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?m:I}},{key:"isBrowserOK",value:function(e){if(g.isString(e)){if(""==e||"0"==e)return m;var n=(e=e.toLowerCase()).split(";"),t=I,r=T.navInfoSync;return g.each(n,(function(e){("chrome"==g.trim(e)&&(r.bChrome||r.bSafari||r.bOpera||r.bEdge)||"ie"==g.trim(e)&&r.bIE||"firefox"==g.trim(e)&&r.bFirefox)&&(t=m)})),t}return I}},{key:"parseDateFromString",value:function(e){var n,t=e;return t=t.replace(/-/g,"/"),n=Date.parse(t),isNaN(n)&&(n=0),(n=new Date(n)).setHours(23,59,59,999),n}},{key:"isAllowLicenseType",value:function(e,n){return n.Core?e.Core:n.PDFRasterizer?e.PDFRasterizer:n.Webcam||n.Camera?e.Webcam:n.barcode1D?e.barcode1D:n.QR?e.QR:n.PDF417?e.PDF417:n.DataMatrix?e.DataMatrix:n.OCR?e.OCR:n.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,n,t){t.Core?g.Errors.LicenseNoCore(e,n):t.Webcam||t.Camera?n||t.Camera?g.Errors.LicenseNotSupportWebcamWasm(e):g.Errors.LicenseNoWebcam(e):t.PDFRasterizer?n?g.Errors.LicenseNotSupportPdfRWasm(e):g.Errors.LicenseNoPDF(e):t.OCR?g.Errors.LicenseNoOCR(e):t.OCRPro?g.Errors.LicenseNoOCRPro(e):g.Errors.LicenseEmptyOrInvalid(e)}},{key:"getLicenseDateString",value:function(e){var n,t=e.getFullYear();return[(n=e.getMonth()+1)>=10?""+n:"0"+n,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",t].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,n){if(n==T.DWT.EnumDWT_ImageType.IT_PDF||n==T.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF){var t;if(g.product.bHTML5Edition?e.__addon&&e.__addon.PDF&&(t=e.__addon.PDF.GetConvertMode()):e.Addon&&e.Addon.PDF&&(t=e.Addon.PDF.GetConvertMode()),1==t||4==t)return this.checkProductKey(e,{PDFRasterizer:!0},!0)}return m}},{key:"getPublicLicenseContent",value:function(e){var n=[],t=e;if(!g.isString(t)){if(g.isUndef(t))return"";t=t instanceof Error||"message"in t?t.message:""+t}var r=t.indexOf("["),i=t.indexOf("]",r),o=t.indexOf("(",i),a=t.indexOf(")",o);if(-1==r||-1==i||-1==o||-1==a)return t;r>0&&n.push(t.substring(0,r));var s=t.substring(r+1,i),u=t.substring(o+1,a);return n.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),n.push(t.substring(a+1)),n.join("")}},{key:"getLTSLicense",value:function(){return T.Lib.product.bPublicLTS?"":T.Lib.product.handshakeCode||T.Lib.product.organizationID}}]),e}();function br(e){var n,t,r=e,i=e.indexOf("-"),o=-1!=i;return t={},o&&(r=e.substring(0,i)),(n=Number(r))!=NaN&&String(Number(n))===r&&(o?t.handshakeCode=e:t.organizationID=e,t.LTS=m),t}function Pr(e){S({_pLoad:{isEmpty:m},_license:e,_licenseServer:[]})}function Cr(e,n){var t=!0;if(g.isArray(e)&&e.length>0){var r=e[0];g.isString(r)&&""!=r&&-1==r.indexOf("https://mlts.dynamsoft.com")&&(t=!1)}return t&&(!n||"200001"===n||g.startsWith(n,"200001-"))}function Ar(e,n,t){return this.checkOSForAllowCore(e,n,t)}function yr(e,n,t,r,i,o){var a,s=o;if(n&&n.LTS){if(!n||!g.isArray(n.Detail)||0==n.Detail.length)return this.isLTS()?g.Errors.LicenseNoCore(e,t):g.Errors.LicenseEmptyOrInvalid(e),zt(this,hr,Lr).call(this,"",!0),I}else if(!n||!g.isArray(n.Detail)||0==n.Detail.length)return this.isLTS()?g.Errors.LicenseNoCore(e,t):g.Errors.LicenseEmptyOrInvalid(e),zt(this,hr,Lr).call(this,"",!0),I;var u,c,l,f,d=0,h=0,S=[],E=[],v=I,w=I,W=I,b=I,P=I;if(!this.isBindDomainOK(n.Domain))return g.Errors.LicenseBadDomain(e),s&&zt(this,pr,Dr).call(this,He(e)),I;for(n.Detail.length>0&&(a="FALSE"!=(l=n.Detail[0]).Trial),c=1;c<n.Detail.length;c++)if("FALSE"==(l=n.Detail[c]).Trial&&a||"TRUE"==l.Trial&&!a)return g.Errors.LicenseTrialFullMixed(e),s&&zt(this,pr,Dr).call(this,He(e)),I;if(r.Core||r.Webcam){var C,A=[],y=!1;for(c=0;c<n.Detail.length;c++)if(l=n.Detail[c],(f=zt(this,Er,kr).call(this,l.EnumLicenseType,l.LicenseType)).AndroidW&&!T.navInfoSync.bAndroid&&(l.OS=g.replaceAll(l.OS,"Wasm","AndroidW")),r.Core&&f.Core&&this.checkOSForAllowCore(t,l.OS,e)||r.Core&&f.Core&&g.product.bActiveXEdition&&f.ActiveX||r.Webcam&&f.Webcam&&!t){if(n.LTS);else if(f.Webcam);else if(!g.isString(l.Version)||0!=l.Version.indexOf(Yt)){A.push(l);continue}if(g.product.bHTML5Edition){if(f.ActiveX&&!f.Html5)continue;E.push(l)}else{if(!f.ActiveX&&f.Html5)continue;E.push(l)}y=!0}if(!y&&A.length>0)return A.splice(0),C=[p,_].join("."),g.Errors.LicenseVersionNotCurrent(e,C),s&&zt(this,pr,Dr).call(this,He(e)),!1;A.splice(0)}else E=n.Detail;for(c=0;c<E.length;c++){var D=m;if(l=E[c],(f=zt(this,Er,kr).call(this,l.EnumLicenseType,l.LicenseType)).AndroidW&&!T.navInfoSync.bAndroid&&(l.OS=g.replaceAll(l.OS,"Wasm","AndroidW")),r.Core&&f.Core||this.isAllowLicenseType(f,r)){u=l.ExpireDate.replace(/-/g,"/");var O="FALSE"!=l.Trial;if(O&&!T.DWT.HideTrialMessage){var L=this.remainExpireDays(u);L<=5&&(g.isFunction(T.OnLicenseExpiredMessage)&&T.OnLicenseExpiredMessage(u,L),T.DWT.HideTrialMessage=!0)}if(this.isExpiredOrFuture(u,O))S.push(u);else if(n.LTS||f.Core&&g.product.bHTML5Edition&&parseInt(l.Version)>=Jt||f.Core&&g.product.bActiveXEdition||!f.Core){var R=!1;if(f.Core)(this.checkOSForAllowCore(t,l.OS,e)||g.product.bActiveXEdition&&f.ActiveX)&&(R=!0);else{var F=t;r.Camera&&(F=!0),zt(this,Tr,Ar).call(this,F,l.OS,e)&&(R=!0)}R?this.isBrowserOK(l.Browser)||i?(d++,D=I):w=m:r.Core?v=m:r.PDFRasterizer?b=m:(r.Webcam||r.Camera)&&(P=m)}else W=m;D&&h++}}if(d>0)return m;if(0==h)return this.setNoAllowedLicenseTypeError(e,t,r),s&&zt(this,pr,Dr).call(this,He(e)),I;if(S.length>0){var N,k=0,x=1e20,M="",B=(new Date).getTime();for(u="",c=0;c<S.length;c++)(N=this.parseDateFromString(S[c])).getTime()<B&&N.getTime()>k?(k=N.getTime(),u=S[c]):N.getTime()>B&&N.getTime()<x&&(x=N.getTime(),M=S[c]);return""!=u?(N=this.parseDateFromString(u),u=this.getLicenseDateString(N),g.Errors.LicenseExpired(e,u),this.isLTS()||zt(this,hr,Lr).call(this,u,a),s=!1):""!=M?(N=this.parseDateFromString(M),M=this.getLicenseDateString(N),g.Errors.LicenseIsFuture(e,M)):(g.Errors.LicenseExpired(e,""),s=!1,zt(this,hr,Lr).call(this)),s&&zt(this,pr,Dr).call(this,He(e)),I}if(W)return g.Errors.LicenseLower(e),s&&zt(this,pr,Dr).call(this,He(e)),I;var G=T.navInfoSync;return w?(G.bEdge?g.Errors.LicenseNoEdge(e):G.bChrome?g.Errors.LicenseNoChrome(e):G.bFirefox?g.Errors.LicenseNoFirefox(e):G.bIE?g.Errors.LicenseNoIE(e):G.bSafari?g.Errors.LicenseNoSafari(e):g.Errors.LicenseNotSupportBorwser(e),s&&zt(this,pr,Dr).call(this,He(e)),I):v?(this.setNoAllowedLicenseTypeError(e,t,{Core:!0}),s&&zt(this,pr,Dr).call(this,He(e)),I):b?(this.setNoAllowedLicenseTypeError(e,t,{PDFRasterizer:!0}),s&&zt(this,pr,Dr).call(this,He(e)),I):P?(this.setNoAllowedLicenseTypeError(e,t,{Webcam:!0}),s&&zt(this,pr,Dr).call(this,He(e)),I):(g.Errors.LicenseEmptyOrInvalid(e),s&&zt(this,pr,Dr).call(this,He(e)),I)}function Dr(e){var n=0,t=e.message;g.isNumber(e.code)?n=e.code:g.isString(t)&&(n=-1),0!=n&&(ur&&ur.error(t),g.isFunction(T.OnLicenseError)&&T.OnLicenseError(t,n))}function Or(){var e={};return g.Errors.FailedParseProductKey(e),(e=He(e)).code}function Lr(e,n){if(!g.detect.needUpgrade)if(this.isLTS()){var t=T.DWT.licenseException.message;T.OnLTSLicenseError&&T.OnLTSLicenseError(this.getPublicLicenseContent(t))}else zt(this,Sr,Rr).call(this,e,n)}function Rr(e,n){var t=[],r="is not valid",i=screen.width,o=i>640?640:i-10;if(e&&""!=e&&(r=-1==e.indexOf("on")?"has expired on "+e:"has expired "+e),t.push('<div style="padding:0 25px 25px 25px;">'),g.env.bMobile?(t.push("The <strong>ProductKey</strong> is not valid."),n&&(t.push(" Please <br /><ul><li>1. <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product' target='_blank'>Request a trial license</a>.</li>"),t.push("<li>2. <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/web-twain/docs/indepth/development/upgrade.html#update-the-product-key?product=dwt&utm_source=in-product' target='_blank'>Update the ProductKey</a>.</li>"),t.push("</ul>"))):n?(t.push("You are seeing this message because your trial key "),t.push(r),t.push(". Two quick steps to extend your trial: <br /><div><ul>"),t.push("<li style='padding-left:25px'>1.<strong><a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product' target='_blank'>Request a new trial key</a></strong> and follow the instructions to set the new key</li>"),t.push("<li style='padding-left:25px'>2.Refresh your scan page and try again</li>"),t.push("</ul></div>If you run into any issues, please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/company/contact/' target='_blank'>contact us</a>.")):(t.push("You are seeing this message because the license for doc scanning support "),t.push(r),t.push(".<br /><div><ul>"),t.push("<li><strong>If you are the owner of the website</strong>, please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/order/renewalList' target='_blank'>renew your license</a> and follow the instructions to set the new key. Please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/company/contact/' target='_blank'>contact us</a> if you need any help.</li>"),t.push("<li><strong>If you are an end-user</strong>, please inform the owner or developer of this website.</li>"),t.push("</ul></div>")),t.push("</div>"),T.DWT.ShowMessage(t.join(""),{width:o,height:0,headerStyle:1}),g.env.bMobile){var a=g.one(".ds-dwt-ui-dlg-wrap");a&&a.length>0&&(a[0].style.fontSize="1.5em",a[0].style.lineHeight="1.5em")}}function Fr(){zt(this,Sr,Rr).call(this,"",!0)}function Nr(e){var n=I,t=I,r=I,i=I,o=I,a=I,s=I,u=I,c=I;return g.isString(e)&&""!=e&&g.each(e.split(";"),(function(e){var l=1*e;l==Zt||l==$t||l==qt||l==Qt?n=m:l==er?t=m:l==or?r=m:l==ar?i=m:l==sr?o=m:l==nr?a=m:l==tr?s=m:l==rr?u=m:l==ir&&(c=m)})),{Core:n,PDFRasterizer:u,Webcam:s,barcode1D:t,QR:r,PDF417:i,DataMatrix:o,OCR:a,OCRPro:c,AndroidW:I}}function kr(e,n){var t=zt(this,mr,Nr).call(this,e),r=zt(this,vr,xr).call(this,n);return g.each(["Core","Html5","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro","AndroidW"],(function(e){t[e]=t[e]||r[e]})),t}function xr(e){var n=I,t=I,r=I,i=I,o=I,a=I,s=I,u=I,c=I,l=I,f=I,d=I;return e&&""!=e&&("html5;activex;oldie"==(e=e.toLowerCase())?(i=m,n=m):"html5;activex"==e?(t=m,i=m,n=m):e.indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(t=m,n=m):"1d barcode reader"==e?r=m:"2d barcode reader(qrcode)"==e?o=m:"2d barcode reader(pdf417)"==e?a=m:"2d barcode reader(data matrix)"==e?s=m:"ocr"==e?u=m:"webcam"==e?c=m:"pdf rasterizer"==e?l=m:"proocr"==e&&(f=m),e.indexOf("androidw")>-1&&(d=m,t=m)),{Core:n,Html5:t,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:r,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:f,AndroidW:d}}function Mr(e){var n=e.toLowerCase();return n.indexOf("wasm")>-1||n.indexOf("mobile")>-1}function Br(e){if(!e.__calic){if(!function(e){return e._isMobileMode()||!e._blts}(e))return!1;e.__calic=e.__licenseInfo,e._isMobileMode()&&function(){if(!g.product.bFullEdition&&T.WasmEnv&&!T.WasmEnv.wasmLoad)try{T.WasmEnv.resourceDir=T.DWT.ResourcesPath+"/src/",T.WasmEnv.logLevel=T.DWT.Debug?"logDebug":"",T.WasmEnv.load(g.product.refProductKey),T.WasmEnv.wasmLoad=!0}catch(e){e&&g.error(e.message)}}()}return!0}g.License=new Wr,T.DWT.isPublicLicense=function(){return T.Lib.product.bPublicLTS};function Gr(e){var n=e.toLowerCase().replace(g.product.name.toLowerCase()+" ","");return(n=g.replaceAll(n,"[.]",",")).split(",")}var Ur=function(){function e(n,t,r,i){u(this,e);var o=this;o._md5=r,o._length=t,o._content=i}return d(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,n){var t=this,r=n;return g.isNumber(e)&&g.isNumber(n)?e<0||n<=0?"":0==e&&r==t._length?t._content:(e+r>t._length&&(r=t._length-e),t._content.substr(e,r)):""}}]),e}();g.html5.Base64Result=Ur;var Hr=a.navInfoSync,jr={isFunction:function(e){return e&&"function"==typeof e},isReturnSuccess:function(e){if(-2115===e._errorCode)return m;if(-2003===e._errorCode&&!a.DWT.IfHttpPostErrorNoWindow){var n=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==n||n.document.writeln(e.HTTPPostResponseString)}return 0==e._errorCode?m:I},setErrorString:function(e){e._errorCode=e.getSWebTwain().ErrorCode,e._errorString=e.getSWebTwain().ErrorString},checkErrorString:function(e){return jr.setErrorString(e),jr.isReturnSuccess(e)},wrapperRet:function(e,n,t,r,i,o){if(jr.checkErrorString(e)){if(jr.isFunction(t))if(i){var a=e.getSWebTwain().HTTPPostResponseString;a&&""!=a?(e._errorCode=-2003,e._errorString="HTTP process error.",s.isFunction(r)&&r(e._errorCode,e._errorString,a)):t(a)}else{if(o)return t(n),!0;t()}}else jr.isFunction(r)&&(i?r(e._errorCode,e._errorString,e.getSWebTwain().HTTPPostResponseString):r(e._errorCode,e._errorString));return n},wrapperPromise:function(e,n){return jr.setErrorString(e),0==e._errorCode?s.Promise.resolve(n):s.Promise.reject({code:e._errorCode,message:e._errorString})},getImageType:st,replaceLocalFilename:function(e){var n=e;return Hr.bFileSystem&&(n=decodeURI(n)),n},makeParams:function(){var e=arguments;return e===undefined||0===e.length?undefined:e}};s.checkErrorString=jr.checkErrorString,s.wrapperRet=jr.wrapperRet,s.setErrorString=jr.setErrorString,s.DynamicLoadAddonFuns=[],s.attachAddon=function(e){if(Hr.bWin){var n,t=!a.navInfo.bOSx64||a.navInfo.bWOW64,r=e.getSWebTwain();n=t?"DynamicPdfCore_"+a.DWT.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+a.DWT.ActiveXPdfVersion+".dll";try{r.GetAddOnVersion("pdf",n)["catch"]((function(){}))}catch(i){}s.each(s.DynamicLoadAddonFuns,(function(n){s.isFunction(n)&&n(e)}))}};function Vr(e){var n=this;n._stwain=e,s.attachAxViewerPropertyUI(n),s.attachAxViewerFunctions(n),n._thumbnailViewer=null}s.attachProperty=function(e){var n=e,t=function(e,t,r){var i;0!==t&&1!==t?i=t:(i={},t&&(i.set=1==r?function(t){return t*=1,!s.isNumber(t)||isNaN(t)?(s.Errors.InvalidValue(n),I):(n.getSWebTwain()[e]=t,jr.checkErrorString(n))}:2==r?function(t){return s.isBoolean(t)?(n.getSWebTwain()[e]=t,jr.checkErrorString(n)):(s.Errors.InvalidValue(n),I)}:function(t){return s.isString(t)?(n.getSWebTwain()[e]=t,jr.checkErrorString(n)):(s.Errors.InvalidValue(n),I)})),i.get||(i.get=function(){var t=n.getSWebTwain()[e];return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,t}),e in n||Object.defineProperty(n,e,i)};t("ErrorCode",{get:function(e){return n._errorCode}}),t("ErrorString",{get:function(e){return n._errorString}}),t("LogLevel",{get:function(){var e=n.getSWebTwain().LogLevel;return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,e},set:function(e){var t=1*e;return!s.isNumber(t)||isNaN(t)?(s.Errors.InvalidValue(n),I):(n.getSWebTwain().LogLevel=t,jr.checkErrorString(n))}}),t("Manufacturer",1),t("ProductFamily",1),t("ProductKey",{get:function(){return a.DWT.ProductKey},set:function(e){var t=m,r=e;if(r=s.isString(r)?s.trim(r):"",a.DWT.ProductKey=r,a.Lib.License.reparseProductKey(),n.__licenseInfo=undefined,""==r)t=I,s.License.checkProductKey(n,{Core:m},I,m);else{var i=a.DWT.licenseException;if(0!=i.code)return n._errorCode=i.code,n._errorString=i.message,t;n.__licenseInfo=undefined,n.GetLicenseInfo(r),t=jr.checkErrorString(n)}return t}}),t("ProductName",1),t("VersionInfo",1),t("BitDepth",1,1),t("Brightness",1,1),t("Contrast",1,1),t("CurrentSourceName",0),t("DataSourceStatus",0),t("DefaultSourceName",0),t("Duplex",0),t("IfAppendImage",1,2),t("IfAutoBright",1,2),t("IfAutoDiscardBlankpages",1,2),t("IfAutoFeed",1,2),t("IfAutomaticBorderDetection",1,2),t("IfAutomaticDeskew",1,2),t("IfAutoScan",1,2),t("IfDisableSourceAfterAcquire",1,2),t("IfDuplexEnabled",1,2),t("IfFeederEnabled",1,2),t("IfModalUI",1,2),t("IfScanInNewThread",1,2),t("IfShowCancelDialogWhenImageTransfer",1,2),t("IfShowUI",1,2),t("IfShowIndicator",1,2),t("IfUseTwainDSM",1,2),t("IfFeederLoaded",0,2),t("IfPaperDetectable",0,2),t("IfUIControllable",0,2),t("ImageBitsPerPixel",0),t("ImageCaptureDriverType",1,1),t("ImageLayoutDocumentNumber",0),t("ImageLayoutFrameBottom",0),t("ImageLayoutFrameLeft",0),t("ImageLayoutFrameNumber",0),t("ImageLayoutFrameRight",0),t("ImageLayoutFrameTop",0),t("ImageLayoutPageNumber",0),t("ImageLength",0),t("ImagePixelType",0),t("ImageWidth",0),t("ImageXResolution",0),t("ImageYResolution",0),t("MagData",0),t("MagType",0),t("PageSize",1,1),t("PendingXfers",0),t("PixelFlavor",1,1),t("PixelType",1,1),t("Resolution",1,1),t("SourceCount",0),t("TransferMode",1,1),t("Unit",1,1),t("XferCount",1,1),t("Capability",1,1),t("CapCurrentIndex",1,1),t("CapCurrentValue",1,1),t("CapDefaultIndex",0),t("CapDefaultValue",0),t("CapDescription",1),t("CapMaxValue",1,1),t("CapMinValue",1,1),t("CapNumItems",1,1),t("CapStepSize",1,1),t("CapType",1,1),t("CapValue",1,1),t("CapValueString",1),t("CapValueType",1,1),t("AllowMultiSelect",1,2),t("BackgroundColor",1,1),t("BackgroundFillColor",1,1),t("BlankImageCurrentStdDev",0),t("BlankImageMaxStdDev",1,1),t("BlankImageThreshold",1,1),t("CurrentImageIndexInBuffer",{set:function(e){return e!=n.getSWebTwain().CurrentImageIndexInBuffer&&(n.getSWebTwain().CurrentImageIndexInBuffer=e),jr.checkErrorString(n)}}),t("FitWindowType",1,1),t("HowManyImagesInBuffer",0),t("IfFitWindow",1,2),t("ImageMargin",1,1),t("MaxImagesInBuffer",1,1),t("MouseX",0),t("MouseY",0),t("SelectionImageBorderColor",1),t("Zoom",1,1),t("MouseShape",1,2),t("SelectedImagesIndices",{get:function(){for(var e=[],t=n.getSWebTwain().SelectedImagesCount,r=0;r<t;r++)e.push(n.getSWebTwain().GetSelectedImageIndex(r));return e}}),t("HTTPPostResponseString",0),t("AsyncMode",1,2),t("FTPPassword",1),t("FTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().FTPPort=e,jr.checkErrorString(n)):I}}),t("FTPUserName",1),t("HTTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().HTTPPort=e,jr.checkErrorString(n)):(e=s.detect.ssl?443:80,n.getSWebTwain().HTTPPort=e,jr.checkErrorString(n))}}),t("HTTPPassword",1),t("HTTPUserName",1),t("IfPASVMode",1,2),t("IfShowProgressBar",1,2),t("ProxyServer",1),t("IfShowFileDialog",1,2),t("IfTiffMultiPage",1,2),t("PDFAuthor",1),t("PDFCompressionType",1,1),t("PDFCreationDate",1),t("PDFCreator",1),t("PDFKeywords",1),t("PDFModifiedDate",1),t("PDFProducer",1),t("PDFSubject",1),t("PDFTitle",1),t("PDFVersion",1),t("TIFFCompressionType",1,1),t("JPEGQuality",{set:function(e){return(e*=1)>=100?e=100:e<0&&(e=0),n.getSWebTwain().JPEGQuality=e,jr.checkErrorString(n)}}),t("HttpContentTypeFieldValue",1),t("SelectionRectAspectRatio",1,1),t("IfAllowLocalCache",1,2),t("_AutoCropMethod",1,2),t("BrokerProcessType",1,1),t("BorderStyle",1,1),t("IfShowPrintUI",1,2),t("VScrollBar",1,2),t("EnableInteractiveZoom",1,2),t("ImageEditorIfEnableEnumerator",1,2),t("ImageEditorIfReadonly",1,2),t("ImageEditorIfModal",1,2),t("ImageEditorWindowTitle",1),t("IfSSL",1,2),t("AllowPluginAuthentication",1,2),t("HttpFieldNameOfUploadedImage",1),t("MaxInternetTransferThreads",1,1),t("MaxUploadImageSize",1,1),t("IfOpenImageWithGDIPlus",1,2),t("BufferMemoryLimit",1,1),t("Width",{get:function(){return n.getSWebTwain().style.width},set:function(e){return n._ChangeWidth(e),jr.checkErrorString(n)}}),t("Height",{get:function(){return n.getSWebTwain().style.height},set:function(e){return n._ChangeHeight(e),jr.checkErrorString(n)}}),t("IfThrowException",1,2),t("IfAutoScroll",1,2),t("ShowPageNumber",{get:function(){return I},set:function(e){return I}}),t("UseLocalService",{get:function(){return!0}})},s.attachMethod=function(e){var t=e,r=function(e){return s.License.checkProductKey(t,{Core:m})?m:(s.isFunction(e)&&e(t.ErrorCode,t.ErrorString),I)},i=function(e,n){return s.License.checkPDFProductKeyWhenNeeds(t,e)?m:(s.isFunction(n)&&n(t.ErrorCode,t.ErrorString),I)},u=function(e,n){return 0!=e.HowManyImagesInBuffer||(s.Errors.NoImage(e),s.isFunction(n)&&n(e.ErrorCode,e.ErrorString),!1)},c=function(e,n,t){return!!u(e,t)&&(!(isNaN(n)||!s.isNumber(n)||n<0||n>=e.HowManyImagesInBuffer)||(s.Errors.IndexOutOfRange(e),s.isFunction(t)&&t(e.ErrorCode,e.ErrorString),!1))};e.UnregisterEvent=function(e,n){if(!s.isString(e))return s.Errors.InvalidEventName(t),!1;if("onwsmessage"===e.toLowerCase())return s.Errors.InvalidEventName(t),!1;if("OnPostAllTransfers"===e)return t.__OnPostAllTransfers=null,!0;if("OnBufferChanged"===e)return t.__OnBufferChanged=null,!0;if("OnBitmapChanged"===e)return t.__OnBitmapChanged=null,!0;t.getSWebTwain().UnregisterEvent(e,(function(){}));var r=["__",e].join("");return t[r]=null,jr.checkErrorString(t)},e.RegisterEvent=function(e,n){if(!s.isString(e))return s.Errors.InvalidEventName(t),!1;var r=e.toLowerCase();if("onwsmessage"===r)return s.Errors.InvalidEventName(t),!1;if(s.isFunction(n)){if("onpostalltransfers"===r)return t.__OnPostAllTransfers=n,!0;if("onbufferchanged"===r)return t.__OnBufferChanged=n,!0;if("onbitmapchanged"===r)return t.__OnBitmapChanged=n,!0;var i=["__",e].join("");return t[i]=n,t.getSWebTwain().RegisterEvent(e,n),jr.checkErrorString(t)}return!0},e.onEvent=function(e,n){return t.RegisterEvent(e,n)},e.on=function(e,n){return t.RegisterEvent(e,n)},e._isMobileMode=function(){return!1},e.CancelAllPendingTransfers=function(){return t.getSWebTwain().CancelAllPendingTransfers(),jr.checkErrorString(t)},e.CloseSource=function(){return t.getSWebTwain().CloseSource(),jr.checkErrorString(t)},e.CloseSourceManager=function(){return t.getSWebTwain().CloseSourceManager(),jr.checkErrorString(t)},e.DisableSource=function(){return t.getSWebTwain().DisableSource(),jr.checkErrorString(t)},e.FeedPage=function(){return t.getSWebTwain().FeedPage(),jr.checkErrorString(t)},e.GetDeviceType=function(){var e=t.getSWebTwain().GetDeviceType();return jr.setErrorString(t),e},e.GetSourceNameItems=function(e){var n=t.getSWebTwain().GetSourceNameItems(e);return jr.setErrorString(t),n},e.SourceNameItems=function(e){var n=t.getSWebTwain().GetSourceNameItems(e);return jr.setErrorString(t),n},e.GetSourceNames=function(){var n,r,i=[];for(n=t.getSWebTwain().SourceCount,r=0;r<n;r++){var o=e.GetSourceNameItems(r);i.push(o)}return i},e.GetSourceType=function(e){var n=t.getSWebTwain().GetSourceType(e);return jr.setErrorString(t),n},e.OpenSource=function(){return t.getSWebTwain().OpenSource(),jr.checkErrorString(t)},e.OpenSourceManager=function(){return t.getSWebTwain().OpenSourceManager(),jr.checkErrorString(t)},e.ResetImageLayout=function(){return t.getSWebTwain().ResetImageLayout(),jr.checkErrorString(t)},e.RewindPage=function(){return t.getSWebTwain().RewindPage(),jr.checkErrorString(t)},e.SelectSource=function(e,n){return s.isUndefined(e)?(t.getSWebTwain().SelectSource(),jr.checkErrorString(t)):(t.getSWebTwain().SelectSource(),jr.checkErrorString(t)?(e(),!0):(n(),!1))},e.SelectSourceByIndex=function(e){return t.getSWebTwain().SelectSourceByIndex(e),jr.checkErrorString(t)},e.CloseSourceAsync=function(){return jr.wrapperPromise(t,t.CloseSource())},e.CloseSourceManagerAsync=function(){return jr.wrapperPromise(t,t.CloseSourceManager())},e.GetSourceNamesAsync=function(){return jr.wrapperPromise(t,t.GetSourceNames())},e.GetSourceTypeAsync=function(e){return jr.wrapperPromise(t,t.GetSourceType(e))},e.OpenSourceAsync=function(){return jr.wrapperPromise(t,t.OpenSource())},e.OpenSourceManagerAsync=function(){return jr.wrapperPromise(t,t.OpenSourceManager())},e.SelectSourceAsync=function(e){return e&&0==(e&ae)&&0==(e&se)?(s.Errors.InvalidParameterInCallback(t),s.Promise.reject({code:t._errorCode,message:t._errorString})):jr.wrapperPromise(t,t.SelectSource())},e.SelectSourceByIndexAsync=function(e){return jr.wrapperPromise(t,t.SelectSourceByIndex(e))},e.SetFileXferInfo=function(e,n){var r=jr.replaceLocalFilename(e);return t.getSWebTwain().SetFileXferInfo(r,n),jr.checkErrorString(t)},e.SetImageLayout=function(e,n,r,i){return t.getSWebTwain().SetImageLayout(e,n,r,i),jr.checkErrorString(t)},e.CapGet=function(){var e=t.getSWebTwain().CapGet();return jr.setErrorString(t),e},e.CapGetCurrent=function(){var e=t.getSWebTwain().CapGetCurrent();return jr.setErrorString(t),e},e.CapGetDefault=function(){var e=t.getSWebTwain().CapGetDefault();return jr.setErrorString(t),e},e.CapGetFrameBottom=function(e){var n=t.getSWebTwain().CapGetFrameBottom(e);return jr.setErrorString(t),n},e.CapGetFrameLeft=function(e){var n=t.getSWebTwain().CapGetFrameLeft(e);return jr.setErrorString(t),n},e.CapGetFrameRight=function(e){var n=t.getSWebTwain().CapGetFrameRight(e);return jr.setErrorString(t),n},e.CapGetFrameTop=function(e){var n=t.getSWebTwain().CapGetFrameTop(e);return jr.setErrorString(t),n},e.CapGetHelp=function(){var e=t.getSWebTwain().CapGetHelp();return jr.setErrorString(t),e},e.CapGetLabel=function(){var e=t.getSWebTwain().CapGetLabel();return jr.setErrorString(t),e},e.CapGetLabels=function(){var e=t.getSWebTwain().CapGetLabels();return jr.setErrorString(t),e},e.CapIfSupported=function(e){var n=t.getSWebTwain().CapIfSupported(e);return jr.setErrorString(t),n},e.CapReset=function(){return t.getSWebTwain().CapReset(),jr.checkErrorString(t)},e.CapSet=function(){return t.getSWebTwain().CapSet(),jr.checkErrorString(t)},e.CapSetFrame=function(e,n,r,i,o){return t.getSWebTwain().CapSetFrame(e,n,r,i,o),jr.checkErrorString(t)},e.GetCapItems=function(e){var n=t.getSWebTwain().GetCapItems(e);return jr.setErrorString(t),n},e.GetCapItemsString=function(e){var n=t.getSWebTwain().GetCapItemsString(e);return jr.setErrorString(t),n},e.SetCapItems=function(e,n){return t.getSWebTwain().SetCapItems(e,n),jr.checkErrorString(t)},e.SetCapItemsString=function(e,n){return t.getSWebTwain().SetCapItemsString(e,n),jr.checkErrorString(t)},e.AddText=function(e,n,r,i,o,a,u,c){var l=parseInt(e);return isNaN(l)||l<0||l>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().AddText(l,n,r,i,o,a,u,c),jr.checkErrorString(t))},e.CreateTextFont=function(e,n,r,i,o,a,s,u,c,l,f,d,T,g){return t.getSWebTwain().CreateTextFont(e,n,r,i,o,a,s,u,c,l,f,d,T,g),jr.checkErrorString(t)},e.CopyToClipboard=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().CopyToClipboard(n),jr.checkErrorString(t))},e.Erase=function(e,n,r,i,o,a,u){var c,l=parseInt(e);return isNaN(l)||l<0||l>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1):(c=t.getSWebTwain().Erase(l,n,r,i,o),jr.wrapperRet(t,c,a,u))},e.GetImageBitDepth=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().GetImageBitDepth(n);return jr.setErrorString(t),r},e.GetImageWidth=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().GetImageWidth(n);return jr.setErrorString(t),r},e.GetImageHeight=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().GetImageHeight(n);return jr.setErrorString(t),r},e.GetImageSize=function(e,n,r){var i=parseInt(e);if(isNaN(i)||i<0||i>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var o=t.getSWebTwain().GetImageSize(i,n,r);return jr.setErrorString(t),o},e.GetImageSizeWithSpecifiedType=function(e,n){var r=parseInt(e);if(isNaN(r)||r<0||r>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var i=t.getSWebTwain().GetImageSizeWithSpecifiedType(r,n);return jr.setErrorString(t),i},e.GetImageXResolution=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().GetImageXResolution(n);return jr.setErrorString(t),r},e.GetImageYResolution=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().GetImageYResolution(n);return jr.setErrorString(t),r},e.CopyToClipboardAsync=function(e){return jr.wrapperPromise(t,t.CopyToClipboard(e))},e.EraseAsync=function(e,n,r,i,o){return jr.wrapperPromise(t,t.Erase(e,n,r,i,o))},e.GetImageBitDepthAsync=function(e){return jr.wrapperPromise(t,t.GetImageBitDepth(e))},e.GetImageWidthAsync=function(e){return jr.wrapperPromise(t,t.GetImageWidth(e))},e.GetImageHeightAsync=function(e){return jr.wrapperPromise(t,t.GetImageHeight(e))},e.GetImageSizeAsync=function(e,n,r){return jr.wrapperPromise(t,t.GetImageSize(e,n,r))},e.GetImageSizeWithSpecifiedTypeAsync=function(e,n){return jr.wrapperPromise(t,t.GetImageSizeWithSpecifiedType(e,n))},e.GetImageXResolutionAsync=function(e){return jr.wrapperPromise(t,t.GetImageXResolution(e))},e.GetImageYResolutionAsync=function(e){return jr.wrapperPromise(t,t.GetImageYResolution(e))},e.SelectAllImages=function(){var e,n=t.getSWebTwain().HowManyImagesInBuffer,r=[];for(t.getSWebTwain().SelectedImagesCount=n,e=0;e<n;e++)t.getSWebTwain().SetSelectedImageIndex(e,e),r.push(e);return jr.checkErrorString(t),r},e.SelectImages=function(e){var n=e.length;t.getSWebTwain().SelectedImagesCount=n;for(var r=0;r<n;r++)t.getSWebTwain().SetSelectedImageIndex(r,e[r]);return jr.checkErrorString(t)},e.GetSelectedImagesSize=function(e){var n=t.getSWebTwain().GetSelectedImagesSize(e);return jr.setErrorString(t),n},e.GetSkewAngle=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().GetSkewAngle(o),jr.wrapperRet(t,i,n,r,!1,!0))},e.GetSkewAngleEx=function(e,n,r,i,o,a,u){var c,l=parseInt(e);return isNaN(l)||l<0||l>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1):(c=t.getSWebTwain().GetSkewAngleEx(l,n,r,i,o),jr.wrapperRet(t,c,a,u))},e.IsBlankImage=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().IsBlankImage(n);return jr.setErrorString(t),r},e.IsBlankImageEx=function(e,n,r,i,o,a){var u=parseInt(e);if(isNaN(u)||u<0||u>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var c=t.getSWebTwain().IsBlankImageEx(u,n,r,i,o,a);return jr.setErrorString(t),c},e.Mirror=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().Mirror(o),jr.wrapperRet(t,i,n,r))},e.OverlayRectangle=function(e,n,r,i,o,a,s){return t.getSWebTwain().OverlayRectangle(e,n,r,i,o,a,s),jr.checkErrorString(t)},e.RemoveAllImages=function(){var e;return t.getSWebTwain().RemoveAllImages(),(e=jr.checkErrorString(t))&&t.__innerRefreshImage(),t.Width=parseInt(t.Width)+2,e},e.RemoveAllSelectedImages=function(){var e;return t.getSWebTwain().RemoveAllSelectedImages(),(e=jr.checkErrorString(t))&&t.__innerRefreshImage(),e},e.RemoveImage=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().RemoveImage(n),jr.checkErrorString(t))},e.MirrorAsync=function(e){return jr.wrapperPromise(t,t.Mirror(e))},e.RemoveAllImagesAsync=function(){return jr.wrapperPromise(t,t.RemoveAllImages())},e.RemoveAllSelectedImagesAsync=function(){return jr.wrapperPromise(t,t.RemoveAllSelectedImages())},e.RemoveImageAsync=function(e){return jr.wrapperPromise(t,t.RemoveImage(e))},e.Rotate=function(e,n,r,i,o){var a,u=parseInt(e);return isNaN(u)||u<0||u>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(o)&&o(t.ErrorCode,t.ErrorString),!1):(a=t.getSWebTwain().Rotate(u,n,r),jr.wrapperRet(t,a,i,o))},e.RotateEx=function(e,n,r,i,o,a){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().RotateEx(c,n,r,i),jr.wrapperRet(t,u,o,a))},e.RotateLeft=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().RotateLeft(o),jr.wrapperRet(t,i,n,r))},e.RotateRight=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().RotateRight(o),jr.wrapperRet(t,i,n,r))},e.ChangeImageSize=function(e,n,r,i,o,a){var u,c=parseInt(e);return isNaN(c)||c<0||c>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):n<=0||r<=0?(s.Errors.InvalidWidthOrHeight(t),s.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1):(u=t.getSWebTwain().ChangeImageSize(c,n,r,i),jr.wrapperRet(t,u,o,a))},e.Flip=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().Flip(o),jr.wrapperRet(t,i,n,r))},e.Crop=function(e,n,r,i,o,a,u){var c,l=parseInt(e);return isNaN(l)||l<0||l>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1):(c=t.getSWebTwain().Crop(l,n,r,i,o),jr.wrapperRet(t,c,a,u))},e.CropToClipboard=function(e,n,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().CropToClipboard(a,n,r,i,o),jr.checkErrorString(t))},e.CutFrameToClipboard=function(e,n,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().CutFrameToClipboard(a,n,r,i,o),jr.checkErrorString(t))},e.CutToClipboard=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().CutToClipboard(n),jr.checkErrorString(t))},e.RotateAsync=function(e,n,r){return jr.wrapperPromise(t,t.Rotate(e,n,r))},e.RotateExAsync=function(e,n,r,i){return jr.wrapperPromise(t,t.RotateEx(e,n,r,i))},e.RotateLeftAsync=function(e){return jr.wrapperPromise(t,t.RotateLeft(e))},e.RotateRightAsync=function(e){return jr.wrapperPromise(t,t.RotateRight(e))},e.ChangeImageSizeAsync=function(e,n,r,i){return jr.wrapperPromise(t,t.ChangeImageSize(e,n,r,i))},e.FlipAsync=function(e){return jr.wrapperPromise(t,t.Flip(e))},e.CropAsync=function(e,n,r,i,o){return jr.wrapperPromise(t,t.Crop(e,n,r,i,o))},e.CropToClipboardAsync=function(e,n,r,i,o){return jr.wrapperPromise(t,t.CropToClipboard(e,n,r,i,o))},e.CutFrameToClipboardAsync=function(e,n,r,i,o){return jr.wrapperPromise(t,t.CutFrameToClipboard(e,n,r,i,o))},e.CutToClipboardAsync=function(e){return jr.wrapperPromise(t,t.CutToClipboard(e))},e.InvertAsync=function(e){return jr.wrapperPromise(t,t.Invert(e))},e.Invert=function(e){var n=parseInt(e);return isNaN(n)||n<0||n>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(s.Errors.ActiveXNotSupport(t),!1)},e.SetDPI=function(e,n,r,i,o,a,u){var c,l=parseInt(e);return isNaN(l)||l<0||l>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1):(c=t.getSWebTwain().SetDPI(l,n,r,i,o),jr.wrapperRet(t,c,a,u))},e.SetViewMode=function(e,n){return t.getSWebTwain().SetViewMode(e,n),jr.checkErrorString(t)},e.GetViewModeH=function(){var e=t.getSWebTwain().GetViewModeH();return jr.setErrorString(t),e},e.GetViewModeV=function(){var e=t.getSWebTwain().GetViewModeV();return jr.setErrorString(t),e},e.MoveImage=function(e,n){var r=parseInt(e),i=parseInt(n);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer||isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().MoveImage(r,i),jr.checkErrorString(t))},e.SwitchImage=function(e,n){var r=parseInt(e),i=parseInt(n);return isNaN(r)||r<0||r>=t.HowManyImagesInBuffer||isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().SwitchImage(r,i),jr.checkErrorString(t))},e.Print=function(){return t.getSWebTwain().Print(),jr.checkErrorString(t)},e.checkErrorString=function(){return jr.isReturnSuccess(t)},e.FileExists=function(e){var n=jr.replaceLocalFilename(e),r=t.getSWebTwain().FileExists(n);return jr.setErrorString(t),r},e.SaveAllAsMultiPageTIFF=function(e,n,r){if(!u(t,r))return!1;var i,o=jr.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsMultiPageTIFF(o),jr.wrapperRet(t,i,n,r)},e.SaveAllAsPDF=function(e,n,r){if(!u(t,r))return!1;var i,o=jr.replaceLocalFilename(e);return i=t.getSWebTwain().SaveAllAsPDF(o),jr.wrapperRet(t,i,n,r)},e.SaveAsBMP=function(e,n,r,i){if(!c(t,n,i))return!1;var o,a=jr.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsBMP(a,n),jr.wrapperRet(t,o,r,i)},e.SaveAsJPEG=function(e,n,r,i){if(!c(t,n,i))return!1;var o,a=jr.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsJPEG(a,n),jr.wrapperRet(t,o,r,i)},e.SaveAsPDF=function(e,n,r,i){if(!c(t,n,i))return!1;var o,a=jr.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsPDF(a,n),jr.wrapperRet(t,o,r,i)},e.SaveAsPNG=function(e,n,r,i){if(!c(t,n,i))return!1;var o,a=jr.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsPNG(a,n),jr.wrapperRet(t,o,r,i)},e.SaveAsTIFF=function(e,n,r,i){if(!c(t,n,i))return!1;var o,a=jr.replaceLocalFilename(e);return o=t.getSWebTwain().SaveAsTIFF(a,n),jr.wrapperRet(t,o,r,i)},e.SaveSelectedImagesAsMultiPagePDF=function(e,n,r){var i,o=jr.replaceLocalFilename(e);return i=t.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(o),jr.wrapperRet(t,i,n,r)},e.SaveSelectedImagesAsMultiPageTIFF=function(e,n,r){var i,o=jr.replaceLocalFilename(e);return i=t.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(o),jr.wrapperRet(t,i,n,r)},e.SaveSelectedImagesToBase64Binary=function(e,n){var r=t.getSWebTwain().SaveSelectedImagesToBase64Binary();return jr.wrapperRet(t,r,e,n)},e.ShowFileDialog=function(e,n,r,i,o,a,s,u){return t.getSWebTwain().ShowFileDialog(e,n,r,i,o,a,s,u),jr.checkErrorString(t)},e.FTPDownload=function(e,n,i,o){if(!r(o))return!1;var u=t.getSWebTwain().FTPDownload(e,n);return u&&s.License.isLTS()&&a.DWT.lcvrf(t),jr.wrapperRet(t,u,i,o)},e.FTPDownloadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPDownloadDirectly(e,n,i);return jr.wrapperRet(t,s,o,a)},e.FTPDownloadEx=function(e,n,o,s,u){if(!r(u))return!1;if(o!=a.DWT.EnumDWT_ImageType.IT_BMP&&o!=a.DWT.EnumDWT_ImageType.IT_JPG&&o!=a.DWT.EnumDWT_ImageType.IT_TIF&&o!=a.DWT.EnumDWT_ImageType.IT_PNG&&o!=a.DWT.EnumDWT_ImageType.IT_PDF&&o!=a.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,u))return I;var c=t.getSWebTwain().FTPDownloadEx(e,n,o);return jr.wrapperRet(t,c,s,u)},e.FTPUpload=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUpload(e,n,i);return jr.wrapperRet(t,s,o,a)},e.FTPUploadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().FTPUploadDirectly(e,n,i);return jr.wrapperRet(t,s,o,a)},e.FTPUploadEx=function(e,n,i,o,a,s){if(!r(s))return!1;var u=t.getSWebTwain().FTPUploadEx(e,n,i,o);return jr.wrapperRet(t,u,a,s)},e.FTPUploadAllAsMultiPageTIFF=function(e,n,i,o){if(!r(o))return!1;var a=t.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,n);return jr.wrapperRet(t,a,i,o)},e.FTPUploadAllAsPDF=function(e,n,i,o){if(!r(o))return!1;var a=t.getSWebTwain().FTPUploadAllAsPDF(e,n);return jr.wrapperRet(t,a,i,o)},e.FTPUploadAsMultiPagePDF=function(e,n,r,i){var o=t.getSWebTwain().FTPUploadAsMultiPagePDF(e,n);return jr.wrapperRet(t,o,r,i)},e.FTPUploadAsMultiPageTIFF=function(e,n,r,i){var o=t.getSWebTwain().FTPUploadAsMultiPageTIFF(e,n);return jr.wrapperRet(t,o,r,i)},e.HTTPDownloadDirectly=function(e,n,i,o,a){if(!r(a))return!1;var s=t.getSWebTwain().HTTPDownloadDirectly(e,n,i);return jr.wrapperRet(t,s,o,a)},e.HTTPDownload=function(e,n,r,i){var o=jr.getImageType(n);return t.HTTPDownloadEx(e,n,o,r,i)},e.HTTPDownloadEx=function(e,n,o,u,c){if(!r(c))return I;if(o!=a.DWT.EnumDWT_ImageType.IT_BMP&&o!=a.DWT.EnumDWT_ImageType.IT_JPG&&o!=a.DWT.EnumDWT_ImageType.IT_TIF&&o!=a.DWT.EnumDWT_ImageType.IT_PNG&&o!=a.DWT.EnumDWT_ImageType.IT_PDF&&o!=a.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,c))return I;var l=t.getSWebTwain().HTTPDownloadEx(e,n,o);return l&&s.License.isLTS()&&a.DWT.lcvrf(t),jr.wrapperRet(t,l,u,c)},e.HTTPDownloadThroughGet=e.HTTPDownloadEx,e.HTTPUploadThroughPostDirectly=function(e,n,i,o,a,s){if(!r(s))return!1;var u=t.getSWebTwain().HTTPUploadThroughPostDirectly(e,n,i,o);return jr.wrapperRet(t,u,a,s,!0)},e.HTTPUploadThroughPost=function(e,n,r,i,o,a){if(!s.isNumber(n)||isNaN(n)||n<-2)return s.Errors.IndexOutOfRange(t),s.isFunction(a)&&a(t.ErrorCode,t.ErrorString),!1;var u=t.getSWebTwain().HTTPUploadThroughPost(e,n,r,i);return jr.wrapperRet(t,u,o,a,!0)},e.HTTPUploadThroughPostEx=function(e,n,r,i,o,a,u){if(!s.isNumber(n)||isNaN(n)||n<-2)return s.Errors.IndexOutOfRange(t),s.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1;var c=t.getSWebTwain().HTTPUploadThroughPostEx(e,n,r,i,o);return jr.wrapperRet(t,c,a,u,!0)},e.ClearAllHTTPFormField=function(){return t.getSWebTwain().ClearAllHTTPFormField(),jr.checkErrorString(t)},e.SetHTTPFormField=function(e,n){return t.getSWebTwain().SetHTTPFormField(e,n),jr.checkErrorString(t)},e.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,n,r),jr.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPageTIFF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,n,r),jr.wrapperRet(t,a,i,o,!0)},e.HTTPUploadAllThroughPostAsPDF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,n,r),jr.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPagePDF=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,n,r),jr.wrapperRet(t,a,i,o,!0)},e.HTTPUploadThroughPutDirectly=function(e,n,r,i,o){var a;return a=t.getSWebTwain().HTTPUploadThroughPutDirectly(e,n,r),jr.wrapperRet(t,a,i,o)},e.HTTPUploadThroughPut=function(e,n,r,i,o){var a=jr.getImageType(r);return t.HTTPUploadThroughPutEx(e,n,r,a,i,o)},e.HTTPUploadThroughPutEx=function(e,n,r,i,o,a){var s;return s=t.getSWebTwain().HTTPUploadThroughPutEx(e,n,r,i),jr.wrapperRet(t,s,o,a)},e.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-1,n,2,r,i)},e.HTTPUploadThroughPutAsMultiPageTIFF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-2,n,2,r,i)},e.HTTPUploadAllThroughPutAsPDF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-1,n,4,r,i)},e.HTTPUploadThroughPutAsMultiPagePDF=function(e,n,r,i){return t.HTTPUploadThroughPutEx(e,-2,n,4,r,i)},e.ShowImageEditor=function(){return t.getSWebTwain().ShowImageEditor(),jr.checkErrorString(t)},e.SetCookie=function(e){return t.getSWebTwain().SetCookie(e),jr.checkErrorString(t)},e.LoadImageFromBase64Binary=function(e,n,o,u){if(!r())return I;if(n!=a.DWT.EnumDWT_ImageType.IT_BMP&&n!=a.DWT.EnumDWT_ImageType.IT_JPG&&n!=a.DWT.EnumDWT_ImageType.IT_TIF&&n!=a.DWT.EnumDWT_ImageType.IT_PNG&&n!=a.DWT.EnumDWT_ImageType.IT_PDF&&n!=a.DWT.EnumDWT_ImageType.IT_J2K&&(n=-1),!i(n))return s.isFunction(u)&&u(t._errorCode,t._errorString),I;var c=t.getSWebTwain().LoadImageFromBase64Binary(e,n);return jr.setErrorString(t),c?s.isFunction(o)&&o():s.isFunction(u)&&u(t._errorCode,t._errorString),c},e.SaveSelectedImagesToBytes=function(e,n){var r=t.getSWebTwain().SaveSelectedImagesToBytes(e,n);return jr.setErrorString(t),r},e.LoadImageFromBytes=function(e,n,o){if(!r())return I;if(o!=a.DWT.EnumDWT_ImageType.IT_BMP&&o!=a.DWT.EnumDWT_ImageType.IT_JPG&&o!=a.DWT.EnumDWT_ImageType.IT_TIF&&o!=a.DWT.EnumDWT_ImageType.IT_PNG&&o!=a.DWT.EnumDWT_ImageType.IT_PDF&&o!=a.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o))return I;var s=t.getSWebTwain().LoadImageFromBytes(e,n,o);return jr.setErrorString(t),s},e.SetImageWidth=function(e,n,r,i){var o,a=parseInt(e);return isNaN(a)||a<0||a>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1):(o=t.getSWebTwain().SetImageWidth(a,n),jr.wrapperRet(t,o,r,i))},e.HTTPDownloadThroughPost=function(e,n,o,s,u){if(!r(u))return!1;if(o!=a.DWT.EnumDWT_ImageType.IT_BMP&&o!=a.DWT.EnumDWT_ImageType.IT_JPG&&o!=a.DWT.EnumDWT_ImageType.IT_TIF&&o!=a.DWT.EnumDWT_ImageType.IT_PNG&&o!=a.DWT.EnumDWT_ImageType.IT_PDF&&o!=a.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,u))return I;var c=t.getSWebTwain().HTTPDownloadThroughPost(e,n,o);return jr.wrapperRet(t,c,s,u)},e.SetCustomDSDataEx=function(e){return t.getSWebTwain().SetCustomDSDataEx(e),jr.checkErrorString(t)},e.SetCustomDSData=function(e){return t.getSWebTwain().SetCustomDSData(e),jr.checkErrorString(t)},e.GetCustomDSDataEx=function(){var e=t.getSWebTwain().GetCustomDSDataEx();return jr.setErrorString(t),e},e.GetCustomDSData=function(e){var n=t.getSWebTwain().GetCustomDSData(e);return jr.setErrorString(t),n},e.ChangeBitDepth=function(e,n,r){var i=parseInt(e);return isNaN(i)||i<0||i>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),!1):(t.getSWebTwain().ChangeBitDepth(i,n,r),jr.checkErrorString(t))},e.ConvertToGrayScale=function(e,n,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=t.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(t),s.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):(i=t.getSWebTwain().ConvertToGrayScale(e),jr.wrapperRet(t,i,n,r))},e.ShowImageEditorEx=function(e,n,r,i,o){return t.getSWebTwain().ShowImageEditorEx(e,n,r,i,o),jr.checkErrorString(t)},e.ClearTiffCustomTag=function(){return t.getSWebTwain().ClearTiffCustomTag(),jr.checkErrorString(t)},e.SetTiffCustomTag=function(e,n,r){var i=1*e;return a.Lib.isUndef(e)||a.Lib.isUndef(n)?(a.Lib.Errors.InvalidParameter(t),!1):i<=0||i>2147483647?(a.Lib.Errors.InvalidTiffTagError(t),!1):(t.getSWebTwain().SetTiffCustomTag(e,n,r),jr.checkErrorString(t))},e.IsBlankImageExpress=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),!1;var r=t.getSWebTwain().IsBlankImageExpress(n);return jr.setErrorString(t),r},e._ChangeWidth=function(e){var n,r=document.getElementById(t._strDWTInnerContainerID);if(s.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n){var i=parseInt(e);i&&i>2&&(n=i-2+"px")}return n&&(t._strWidth=n,t.getSWebTwain().style.width=n,r&&(r.style.width=n)),m},e._ChangeHeight=function(e){var n,r=document.getElementById(t._strDWTInnerContainerID);if(s.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(n=e),!n){var i=parseInt(e);i&&(n=i+"px")}return n&&(t._strHeight=n,t.getSWebTwain().style.height=n,r&&(r.style.height=n)),m},e.SetSize=function(e,n){return this._ChangeWidth(e),this._ChangeHeight(n),m},e.SetSelectedImageArea=function(e,n,r,i,o){return t.getSWebTwain().SetSelectedImageArea(e,n,r,i,o),jr.checkErrorString(t)},e.SetVideoRotateMode=function(e){return t.getSWebTwain().SetVideoRotateMode(e),jr.checkErrorString(t)},e.SetOpenSourceTimeout=function(e){return t.getSWebTwain().SetOpenSourceTimeout(e),jr.checkErrorString(t)},e.SetHTTPHeader=function(e,n){return!1},e.GetImageURL=function(e,n,t){return""},e.GetImagePartURL=function(e){var n=parseInt(e);if(isNaN(n)||n<0||n>=t.HowManyImagesInBuffer)return s.Errors.IndexOutOfRange(t),"";var r=t.getSWebTwain().GetDIB(n);return jr.setErrorString(t),r},e.GetLicenseInfo=function(e){try{var n,r=!1;if(s.License.isLTS())r=!0,n=t.getSWebTwain().GetLicenseInfo();else if(s.isString(e))if(s.License.isLicenseMixed(e)){var i=a.DWT.licenseException;t._errorCode=i.code,t._errorString=i.message}else s.License.isLongKey(e)?(t.getSWebTwain().ProductKey=e,n=t.getSWebTwain().GetLicenseInfo()):s.Errors.LicenseEmptyOrInvalid(t);else s.Errors.LicenseEmptyOrInvalid(t);if(n&&jr.checkErrorString(t)){var o=s.parse(n);if(o&&o.message)s.Errors.LicenseEmptyOrInvalid(t),t._errorString=o.message,o=undefined;else if(r){if(o&&s.isArray(o.Detail)&&o.Detail.length>0){var u=o.Detail[0].ExpireDate;a.DWT.lsexp(a.DWT.EnumInstance.dwt_desktop,u,"")}o.LTS=!0}l=o,(c=t).__licenseInfo=l,Br(c)}else t.__licenseInfo=undefined}catch(f){t.__licenseInfo=undefined}var c,l;return Promise.resolve(t.__licenseInfo)},e.LoadDibFromClipboard=function(e,n){var r=t.getSWebTwain().LoadDibFromClipboard();return r&&s.License.isLTS()&&a.DWT.lcvrf(t),jr.wrapperRet(t,r,e,n)},e.LoadImage=function(e,n,i){if(!r(i))return!1;var o,u=jr.replaceLocalFilename(e);return(o=t.getSWebTwain().LoadImage(u))&&s.License.isLTS()&&a.DWT.lcvrf(t),jr.wrapperRet(t,o,n,i)},e.LoadImageEx=function(e,n,o,u){if(!r(u))return I;if(n!=a.DWT.EnumDWT_ImageType.IT_BMP&&n!=a.DWT.EnumDWT_ImageType.IT_JPG&&n!=a.DWT.EnumDWT_ImageType.IT_TIF&&n!=a.DWT.EnumDWT_ImageType.IT_PNG&&n!=a.DWT.EnumDWT_ImageType.IT_PDF&&n!=a.DWT.EnumDWT_ImageType.IT_J2K&&(n=-1),!i(n,u))return I;var c,l=jr.replaceLocalFilename(e),f=n;return f==a.DWT.EnumDWT_ImageType.IT_ALL&&(f=-1),(c=t.getSWebTwain().LoadImageEx(l,f))&&s.License.isLTS()&&a.DWT.lcvrf(t),jr.wrapperRet(t,c,o,u)},e.EnableSource=function(e,n,r){return this.AcquireImage(e,n,r),jr.checkErrorString(t)},e.AcquireImage=function(e,n,i){var o,u,c,l=t.getSWebTwain();if(s.isUndefined(i)&&(s.isFunction(e)&&s.isFunction(n)||s.isFunction(e)&&s.isUndefined(n)||s.isFunction(e)&&null==n||null==e&&s.isFunction(n))?(o=null,s.isFunction(e)&&(u=e),s.isFunction(n)&&(c=n)):(o=s.isUndefined(e)||null==e?{}:s.clone(e),s.isFunction(n)&&(u=function(){n(o)}),s.isFunction(i)&&(c=function(){i(o,t._errorCode,t._errorString)})),!r(c))return!1;var f,d=!1;o!==undefined&&null!==o&&(null!=(f=o.SelectSourceByIndex)&&void 0!==f&&(l.SelectSourceByIndex(f),l.CloseSource()),l.OpenSource(),null!=(f=o.IfShowUI)&&void 0!==f&&(l.IfShowUI=f),null!=(f=o.PixelType)&&void 0!==f&&(l.PixelType=f),null!=(f=o.Resolution)&&void 0!==f&&(l.Resolution=f),null!=(f=o.IfFeederEnabled)&&void 0!==f&&(l.IfFeederEnabled=f),null!=(f=o.IfDuplexEnabled)&&void 0!==f&&(l.IfDuplexEnabled=f),null!=(f=o.IfDisableSourceAfterAcquire)&&void 0!==f&&(l.IfDisableSourceAfterAcquire=f),null!=(f=o.IfCloseSourceAfterAcquire)&&void 0!==f&&(d=!!f));return t.getSWebTwain().RegisterEvent("OnPostTransferAsync",(function(e){var n;e&&s.isString(e)&&(n=s.parse(e)),s.isFunction(t.__OnPostTransferAsync)&&t.__OnPostTransferAsync(n)})),t.getSWebTwain().RegisterEvent("OnPostAllTransfers",(function(){jr.checkErrorString(t)?(s.License.isLTS()&&a.DWT.lcvrf(t),s.isFunction(u)&&u()):s.isFunction(c)&&c(t._errorCode,t._errorString),s.isFunction(t.__OnPostAllTransfers)&&t.__OnPostAllTransfers(),d&&l.CloseSource()})),l.AcquireImage(),jr.checkErrorString(t)},e.AcquireImageAsync=function(){var e=n(o.mark((function r(e){var n;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e?s.clone(e):{},r.abrupt("return",new a.Lib.Promise((function(e,r){t.AcquireImage(n,(function(){e(!0)}),(function(){r({code:t._errorCode,message:t._errorString})}))})));case 2:case"end":return r.stop()}}),r)})));return function(n){return e.apply(this,arguments)}}(),e.GetDevicesAsync=function(e,n,r){var i,o=null!=e?e:Te,a=null!=n&&n,s=null!=r&&r;return i=function(e,n){var t,r=[],i=n;if(g.isString(i)&&(i=g.parse(i)),g.isArray(i))for(t=0;t<i.length;t++){var o=Tt(i[t]);r.push(o)}for(t=0;t<r.length;t++){var a=r[t];a.strDevice=g.stringify(a),a.name&&(a.name=g.base64.decode(a.name)),a.deviceInfo&&dt(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,gt(a,null==e?void 0:e._dmService)}return r}(null,i=t.getSWebTwain().GetDevices(o,a,s)),jr.wrapperPromise(t,i)},e.SelectDeviceAsync=function(e,n){var r,i=null!=n?n:_e;if(t._resetErr(),!(e&&e instanceof ut))throw s.Errors.InvalidParameterInCallback(t),{code:t._errorCode,message:t._errorString};return r=t.getSWebTwain().SelectDevice(e.strDevice,i),jr.wrapperPromise(t,r)},e.GenerateURLForUploadData=function(e,n,r){var i=e;return i==a.DWT.EnumDWT_ImageType.IT_ALL&&(i=-1),!0,jr.wrapperRet(t,true,n,r)},e._innerFun=function(e,n,r){var i=t.getSWebTwain(),o=i[e];return"function"==typeof o?o.apply(i,n):o},e.ActiveUI=function(e,n){},e.startScan=function(){return new s.Promise((function(e,n){}))},e.IndexToImageID=function(e){return e},e.ImageIDToIndex=function(e){return e},e.first=function(){return t.HowManyImagesInBuffer>0&&(t.CurrentImageIndexInBuffer=0,t.__innerRefreshImage()),m},e.previous=function(){var e;return t.HowManyImagesInBuffer>0&&(e=t.CurrentImageIndexInBuffer)>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),m},e.next=function(){var e,n=t.HowManyImagesInBuffer;return n>0&&(e=t.CurrentImageIndexInBuffer)>=0&&e<n-1&&(t.CurrentImageIndexInBuffer=e+1,t.__innerRefreshImage()),m},e.last=function(){var e=t.HowManyImagesInBuffer;return e>0&&(t.CurrentImageIndexInBuffer=e-1,t.__innerRefreshImage()),m},e.isUsingActiveX=function(){return!0},e.show=function(){return e.ShowImageEditor()},e.SetLTSInfo=function(e,n){return t.getSWebTwain().SetLTSInfo(e,n)},e.EnableBuffer=function(e){return t.getSWebTwain().Encrypt(e,0)},e.GetBuffer=function(e){return t.getSWebTwain().GetBuffer(e)},e.GetUUID=function(){return t.getSWebTwain().GetUUID()},e.__OnDispatchThumbnailEvt=function(n,t,r){1==r?s.isFunction(e["__"+n+"_Thumbnail"])&&("OnMouseClick"==n||"OnMouseDoubleClick"==n||"OnMouseMove"==n||"OnMouseWheel"==n||"OnKeyDown"==n?e["__"+n+"_Thumbnail"]():e["__"+n+"_Thumbnail"](t)):s.isFunction(e["__"+n])&&e["__"+n](t)},e._OnImageAreaSelected=function(n,t,r,i,o,a){var u="OnImageAreaSelected";1==a?s.isFunction(e["__"+u+"_Thumbnail"])&&e["__"+u+"_Thumbnail"](n,t,r,i,o):s.isFunction(e["__"+u])&&e["__"+u](n,t,r,i,o)};var l=function(e,n){(s.isFunction(e["__"+n])||s.isFunction(e["__"+n+"_Thumbnail"]))&&("OnImageAreaSelected"==n?e.getSWebTwain().RegisterEvent(n,e._OnImageAreaSelected):e.getSWebTwain().RegisterEvent(n,(function(t,r){return e.__OnDispatchThumbnailEvt(n,t,r)})))};e.getSourceCount=function(e){return s.Errors.ActiveXNotSupport(t),s.Promise.resolve(t.getSWebTwain().SourceCount)},e.GetSourceCountAsync=function(e){return s.Errors.ActiveXNotSupport(t),s.Promise.resolve(t.getSWebTwain().SourceCount)},e._resetErr=function(){this._errorCode=0,this._errorString="";var e=a.DWT.licenseException;e.code=0,e.message=""},e._setConvertModeInner=function(e){if(!s.License.checkProductKey(t,{Core:m}))return!1;var n=1*e;return t._resetErr(),isNaN(n)?(s.Errors.ParameterCannotEmpty(t),!1):1!=n&&2!=n&&3!=n&&4!=n?(s.Errors.InvalidValue(t),!1):(t._pdfConvertMode=n,2==n||s.License.hasPDFRProductKey(t)?t._pdfRealConvertMode=n:t._pdfRealConvertMode=2,!0)},e._setConvertMode=function(e){return!!t._setConvertModeInner(e)&&(t.getSWebTwain().SetPDFConvertMode(t._pdfRealConvertMode),!(2==t._pdfRealConvertMode&&1==t._pdfConvertMode||2==t._pdfRealConvertMode&&4==t._pdfConvertMode)||(s.Errors.LicenseNoPDF(t),!1))},e._axNotSupportAsync=function(e){var n=this;return s.Errors.ActiveXNotSupport(n),s.Promise.reject({code:n.ErrorCode,message:n.ErrorString})},e.ConvertToBase64=function(e,n,t,r){var i,o,a=this,u=e;u=s.isArray(u)?u.join(","):-1;var c,l=a.getSWebTwain().SaveImagesToBase64(u,n,(function(e,n){i=e,o=n}));return jr.checkErrorString(a)&&(c=new Ur(null,o,i,l)),jr.wrapperRet(a,[c,e,n],(function(e){t&&t(e[0],e[1],e[2])}),r,!1,!0)},e.ConvertToBlob=function(e,n,t,r){var i=this,o=e;o=s.isArray(o)?o.join(","):-1;var a=i.getSWebTwain().SaveImagesToBytes(o,n,(function(e,n){}));return jr.checkErrorString(i)&&(a=window.VBArray(a).toArray()),jr.wrapperRet(i,[a,e,n],(function(e){t&&t(e[0],e[1],e[2])}),r,!1,!0)},e._checkIndices=function(e){var n,t,r=this;if(!s.isArray(e))return s.Errors.IndicesNotArray(r),!1;if(0==e.length)return s.Errors.IndicesCannotEmpty(r),!1;if(a.DWT.ConnectWithSocket)return!0;for(n=r.HowManyImagesInBuffer,t=0;t<e.length;t++){var i=e[t];if(s.isUndefined(i)||null===i)return s.Errors.IndexNullOrUndefined(r),!1;if(i=parseInt(i),isNaN(i))return s.Errors.InvalidIndex(r),!1;if(i<0||i>=n)return s.Errors.IndicesOutOfRange(r),!1}return!0},e.HTTPUpload=function(e,n,t,r,i,o,a){var u=this,c=n,l=o,f=a,d=arguments;if(!u._checkIndices(n))return f(u._errorCode,u._errorString),!1;c=s.isArray(c)?c.join(","):-1;var T=u.IfSSL,g=u.HTTPPort,p=new s.Uri(e),_=p.scheme,h=p.port;s.isString(_)&&(_=_.toLowerCase()),"https"==_?(u.IfSSL=!0,u.HTTPPort=443):(u.IfSSL=!1,u.HTTPPort=80),h&&(u.HTTPPort=h);var S="RemoteFile";d.length>4&&(s.isFunction(i)?(l=i,d.length>5&&(f=o)):s.isString(i)&&(S=i));var I=u.getSWebTwain().HTTPUpload(p.hostname,c,p.path,S,t,r);return I=jr.wrapperRet(u,I,(function(e){s.isFunction(l)&&l(e,n,d)}),f,!0),u.IfSSL=T,u.HTTPPort=g,I},e.__innerRefreshImage=function(){var e,n=t.HowManyImagesInBuffer;n>0&&(e=t.CurrentImageIndexInBuffer,t.__OnRefreshUI&&t.__OnRefreshUI(e,n))},e.__OnBitmapChangedEx=function(n,r,i,o,u){var c=r,l=u;if(l>-1&&e._blts&&(1==c||2==c)){var f=a.DWT.lgct(l);s.isFunction(t.__OnLtsverify)&&t.__OnLtsverify(f,1)}if(s.isFunction(t.__OnBitmapChanged)&&t.__OnBitmapChanged(n,r,i,o),s.isFunction(t.__OnBufferChanged)){var d=t.CurrentImageIndexInBuffer,T={action:1==c||2==c?"add":3==c?"remove":4==c?"modify":5==c?"shift":"",currentId:d,imageIds:[],selectedIds:[]};-1!=d&&T.selectedIds.push(d),t.__OnBufferChanged(T)}},e._attachEvents=function(){var e,n=t.getSWebTwain();(e=Gr(String(t.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=t.__OnPostTransfer&&n.RegisterEvent("OnPostTransfer",t.__OnPostTransfer),""!=t.__OnPostAllTransfers&&n.RegisterEvent("OnPostAllTransfers",t.__OnPostAllTransfers),""!=t.__OnPostLoad&&n.RegisterEvent("OnPostLoad",t.__OnPostLoad),l(t,"OnMouseClick"),l(t,"OnImageAreaSelected"),l(t,"OnTopImageInTheViewChanged"),l(t,"OnImageAreaDeSelected"),l(t,"OnMouseDoubleClick"),l(t,"OnMouseRightClick"),l(t,"OnMouseMove"),""!=t.__OnGetFilePath&&n.RegisterEvent("OnGetFilePath",t.__OnGetFilePath),""!=t.__OnAfterOperate&&n.RegisterEvent("OnAfterOperate",t.__OnAfterOperate),""!=t.__OnBeforeOperate&&n.RegisterEvent("OnBeforeOperate",t.__OnBeforeOperate),""!=t.__OnOperateStatus&&n.RegisterEvent("OnOperateStatus",t.__OnOperateStatus),n.RegisterEvent("OnBitmapChangedEx",t.__OnBitmapChangedEx),""!=t.__OnPreAllTransfers&&n.RegisterEvent("OnPreAllTransfers",t.__OnPreAllTransfers),""!=t.__OnPreTransfer&&n.RegisterEvent("OnPreTransfer",t.__OnPreTransfer),""!=t.__OnSourceUIClose&&n.RegisterEvent("OnSourceUIClose",t.__OnSourceUIClose),""!=t.__OnTransferCancelled&&n.RegisterEvent("OnTransferCancelled",t.__OnTransferCancelled),""!=t.__OnTransferError&&n.RegisterEvent("OnTransferError",t.__OnTransferError),""!=t.__OnInternetTransferPercentage&&n.RegisterEvent("OnInternetTransferPercentage",t.__OnInternetTransferPercentage),""!=t.__OnInternetTransferPercentageEx&&n.RegisterEvent("OnInternetTransferPercentageEx",t.__OnInternetTransferPercentageEx),l(t,"OnMouseWheel"),l(t,"OnKeyDown"),l(t,"OnPaintDone"))}},s.noControl=function(e){if(a.DWT.IfUseEmbeddedDownloadNoticeForActiveX)!function(e,n,t,r){if(g.product.bActiveXEdition){var i,o,a=g.product,s=T.navInfoSync;if(e&&(g.one(e).before(g.install._strNonInstallDIV),(i=g.get(g.install._divDWTNonInstallContainerID))&&(i.style.width=n,i.style.height=t),g.show(g.install._divDWTNonInstallContainerID),g.hide(e)),""!=g.install._divDWTemessageContainer&&g.hide(g.install._divDWTemessageContainer),o=T.dcp.getDSPath(),r){if(g.isFunction(T.OnWebTwainNeedUpgradeCallback)){var u={"default":o};T.OnWebTwainNeedUpgradeCallback(a.name,u,a.bHTML5Edition,P,s.bIE,s.bSafari,g.detect.ssl,g.env.strIEVersion)}}else g.isFunction(T.OnWebTwainNotFoundOnWindowsCallback)&&T.OnWebTwainNotFoundOnWindowsCallback(a.name,o,a.bHTML5Edition,s.bIE,s.bSafari,g.detect.ssl,g.env.strIEVersion,!1)}}(e._containerElement,e._strWidth,e._strHeight,!1);else{var n=s.product,t="";s.isFunction(a.OnWebTwainNotFoundOnWindowsCallback)&&(t=Hr.bIE||n.bHTML5Edition?a.dcp.getDSPath():n.getMSIPath(),a.OnWebTwainNotFoundOnWindowsCallback(a.DWT.ProductName,t,n.bHTML5Edition,Hr.bIE,Hr.bSafari,s.detect.ssl,s.env.strIEVersion,!1))}},s.attachAxViewerPropertyUI=function(e){var n=function(n,t){n in e||Object.defineProperty(e,n,t)};n("width",{get:function(){return e._stwain.Width},set:function(n){return e._stwain.Width=n,s.checkErrorString(e._stwain)}}),n("height",{get:function(){return e._stwain.Height},set:function(n){return e._stwain.Height=n,s.checkErrorString(e._stwain)}}),n("background",{get:function(){return e._stwain.BackgroundColor},set:function(n){return e._stwain.BackgroundColor=n,n}}),n("cursor",{get:function(){return e._stwain.MouseShape?"pointer":"crosshair"},set:function(n){return e._stwain.MouseShape="pointer"==n,n}}),n("showPageNumber",{get:function(){return!1},set:function(e){return!1}}),n("ifAutoScroll",{get:function(){return e._stwain.IfAutoScroll},set:function(n){return e._stwain.IfAutoScroll=n,n}}),n("pageMargin",{get:function(){return e._stwain.ImageMargin},set:function(n){return e._stwain.ImageMargin=n,n}}),n("zoom",{get:function(){return e._stwain.Zoom},set:function(n){return e._stwain.Zoom=n,n}})},s.attachAxViewerFunctions=function(e){e.next=function(){return this._stwain.next()},e.previous=function(){return this._stwain.previous()},e.first=function(){return this._stwain.first()},e.last=function(){return this._stwain.last()},e.gotoPage=function(e){var n=this,t=1*e;return s.isNaN(t)||!s.isNumber(t)?(s.Errors.InvalidIndex(n._stwain),!1):t<0||t>=n._stwain.HowManyImagesInBuffer?(s.Errors.IndexOutOfRange(n._stwain),!1):(n._stwain.CurrentImageIndexInBuffer=t,t)},e.setSelectedAreas=function(e){return this._stwain.SetSelectedImageArea(this._stwain.CurrentImageIndexInBuffer,e.left,e.top,e.right,e.bottom)},e.fitWindow=function(e){var n=this;return"height"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=w):"width"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=W):(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=v),!0},e.setViewMode=function(e,n){return this._stwain.SetViewMode(e,n)},e.createImageEditor=function(){return this._stwain},e.on=function(e,n){var t,r=this;return""!=(t=r._convertEvtName(e))&&("OnImageAreaSelected"==t?(r.OnImageAreaSelected=function(e,t,r,i,o){n(e,[{x:t,y:r,width:i-t,height:o-r}])},r._stwain.RegisterEvent(t,r.OnImageAreaSelected)):r._stwain.RegisterEvent(t,n))},e.off=function(e,n){var t;return""!=(t=this._convertEvtName(e))&&this._stwain.UnregisterEvent(t,(function(){}))},e.createThumbnailViewer=function(e){var n=this;if(n._thumbnailViewer)s.Errors.ThumbnailViewerExist(n._stwain);else{var t=new s.UI.ThumbnailViewer(n._stwain,e);n._thumbnailViewer=t.getInstance()}return n._thumbnailViewer},e._convertEvtName=function(e){if(!s.isString(e))return"";var n=s.trim(e).toLowerCase();return"toppagechanged"==n?"OnTopImageInTheViewChanged":"click"==n?"OnMouseClick":"dblclick"==n?"OnMouseDoubleClick":"mousemove"==n?"OnMouseMove":"rightclick"==n?"OnMouseRightClick":"wheel"==n?"OnMouseWheel":"keydown"==n?"OnKeyDown":"pageareaselected"==n?"OnImageAreaSelected":"pageareaunselected"==n?"OnImageAreaDeSelected":s.trim(e)}},Vr.prototype.getInstance=function(){return this};var Kr={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:"transparent",pageBorder:"1px solid rgb(238, 238, 238)",hoverPageBackground:"rgb(239, 246, 253)",hoverPageBorder:"1px solid rgb(238, 238, 238)",placeholderBackground:"rgb(251, 236, 136)",autoChangeIndex:!1};function Xr(e,n){var t=this,r=n;if(r){if(r.location)switch(r.location){case"left":default:r.location="horizontal",r.sequence=-1;break;case"right":r.location="horizontal",r.sequence=1;break;case"top":r.location="vertical",r.sequence=-1;break;case"bottom":r.location="vertical",r.sequence=1}else r.location="horizontal",r.sequence=-1;s.isUndefined(r.size)&&(r.size=Kr.size),s.isUndefined(r.columns)&&(r.columns=Kr.columns),s.isUndefined(r.rows)&&(r.rows=Kr.rows),(s.isUndefined(r.scrollDirection)||"horizontal"!=r.scrollDirection)&&(r.scrollDirection=Kr.scrollDirection),s.isUndefined(r.pageMargin)&&(r.pageMargin=Kr.pageMargin),s.isUndefined(r.allowKeyboardControl)&&(r.allowKeyboardControl=Kr.allowKeyboardControl),s.isUndefined(r.allowPageDragging)&&(r.allowPageDragging=Kr.allowPageDragging),s.isUndefined(r.allowResizing)&&(r.allowResizing=Kr.allowResizing),s.isUndefined(r.border)&&(r.border=Kr.border),s.isUndefined(r.pageBackground)&&(r.pageBackground=Kr.pageBackground),s.isUndefined(r.pageBorder)&&(r.pageBorder=Kr.pageBorder),s.isUndefined(r.hoverPageBackground)&&(r.hoverPageBackground=Kr.hoverPageBackground),s.isUndefined(r.hoverPageBorder)&&(r.hoverPageBorder=Kr.hoverPageBorder),s.isUndefined(r.placeholderBackground)&&(r.placeholderBackground=Kr.placeholderBackground),s.isUndefined(r.autoChangeIndex)&&(r.autoChangeIndex=Kr.autoChangeIndex)}else r=Kr;t._stwain=e,t._settings=r,s.attachViewerPropertyThumbnailUI(t),s.attachViewerFunctionsThumbnailUI(t),e.getSWebTwain().SetViewMode(-1,-1),e.getSWebTwain().ShowThumbnail(JSON.stringify(r))}Xr.prototype.getInstance=function(){return this},s.attachViewerFunctionsThumbnailUI=function(e){e.show=function(){e._stwain?(e._stwain.getSWebTwain().SetViewMode(-1,-1),e._stwain.getSWebTwain().ShowThumbnail('{"mode":"show"}')):s.Errors.ThumbnailViewerDispose(e._stwain)},e.hide=function(){e._stwain?e._stwain.getSWebTwain().ShowThumbnail('{"mode":"hide"}'):s.Errors.ThumbnailViewerDispose(e._stwain)},e.dispose=function(){e.hide(),e._stwain=null},e.updateViewMode=function(n){if(e._stwain){if(n&&n.columns&&n.rows){if(n.columns<0||n.rows<0)return s.Errors.InvalidPropertyValue(e._stwain),!1;e._stwain.getSWebTwain().ShowThumbnail('{"columns":'+n.columns+',"rows":'+n.rows+"}")}}else s.Errors.ThumbnailViewerDispose(e._stwain)},e.on=function(n,t){var r=n,i=!1;s.isFunction(t)&&("click"==r&&(r="OnMouseClick"),"rightclick"==r&&(r="OnMouseRightClick"),"dblclick"==r&&(r="OnMouseDoubleClick"),"mousemove"==r&&(r="OnMouseMove"),"wheel"==r&&(r="OnMouseWheel"),"keydown"==r&&(r="OnKeyDown"),"toppagechanged"==r&&(r="OnTopImageInTheViewChanged"),"pageareaselected"==r&&(r="OnImageAreaSelected"),"pageareaunselected"==r&&(r="OnImageAreaDeSelected"),"OnMouseClick"==r||"OnMouseDoubleClick"==r||"OnMouseRightClick"==r||"OnMouseMove"==r||"OnMouseWheel"==r||"OnKeyDown"==r||"OnPaintDone"==r||"OnImageAreaDeSelected"==r||"OnTopImageInTheViewChanged"==r?(s.isFunction(e._stwain["__"+r])||s.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=t,i&&e._stwain.getSWebTwain().RegisterEvent(r,(function(n,t){return e._stwain.__OnDispatchThumbnailEvt(r,n,t)}))):"OnImageAreaSelected"==r&&(s.isFunction(e._stwain["__"+r])||s.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=t,i&&e._stwain.getSWebTwain().RegisterEvent(r,e._stwain._OnImageAreaSelected)))},e.off=function(n,t){e._stwain["__"+n+"_Thumbnail"]=""}},s.attachViewerPropertyThumbnailUI=function(e){var n=function(n,t){n in e||Object.defineProperty(e,n,t)};n("location",{get:function(){return e._settings.location},set:function(n){e._settings.location=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"location":"'+n+'"}')}}),n("size",{get:function(){return e._settings.size},set:function(n){e._settings.size=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"size":"'+n+'"}')}}),n("pageMargin",{get:function(){return e._settings.pageMargin},set:function(n){e._settings.pageMargin=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageMargin":"'+n+'"}')}}),n("background",{get:function(){return e._settings.background},set:function(n){e._settings.background=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"background":"'+n+'"}')}}),n("pageBackground",{get:function(){return e._settings.pageBackground},set:function(n){e._settings.pageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBackground":"'+n+'"}')}}),n("selectedPageBorder",{get:function(){return e._settings.selectedPageBorder},set:function(n){e._settings.selectedPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBorder":"'+n+'"}')}}),n("selectedPageBackground",{get:function(){return e._settings.selectedPageBackground},set:function(n){e._settings.selectedPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBackground":"'+n+'"}')}}),n("scrollDirection",{get:function(){return e._settings.scrollDirection},set:function(n){e._settings.scrollDirection=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"scrollDirection":"'+n+'"}')}}),n("showPageNumber",{get:function(){return e._settings.showPageNumber},set:function(n){e._settings.showPageNumber=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"showPageNumber":"'+n+'"}')}}),n("border",{get:function(){return e._settings.border},set:function(n){e._settings.border=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"border":"'+n+'"}')}}),n("pageBorder",{get:function(){return e._settings.pageBorder},set:function(n){e._settings.pageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBorder":"'+n+'"}')}}),n("hoverPageBackground",{get:function(){return e._settings.hoverPageBackground},set:function(n){e._settings.hoverPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBackground":"'+n+'"}')}}),n("hoverPageBorder",{get:function(){return e._settings.hoverPageBorder},set:function(n){e._settings.hoverPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBorder":"'+n+'"}')}}),n("placeholderBackground",{get:function(){return e._settings.placeholderBackground},set:function(n){e._settings.placeholderBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"placeholderBackground":"'+n+'"}')}}),n("allowKeyboardControl",{get:function(){return e._settings.allowKeyboardControl},set:function(n){e._settings.allowKeyboardControl=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowKeyboardControl":"'+n+'"}')}}),n("allowPageDragging",{get:function(){return e._settings.allowPageDragging},set:function(n){e._settings.allowPageDragging=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowPageDragging":"'+n+'"}')}}),n("allowResizing",{get:function(){return e._settings.allowResizing},set:function(n){e._settings.allowResizing=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowResizing":"'+n+'"}')}}),n("autoChangeIndex",{get:function(){return e._settings.autoChangeIndex},set:function(n){e._settings.autoChangeIndex=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"autoChangeIndex":"'+n+'"}')}})},s.UI=s.UI||{},s.UI.DWTAxViewer=Vr,s.UI.ThumbnailViewer=Xr;var zr,Yr=a.navInfoSync,Jr=document;function qr(e){var n=this,t=e||{};n._containerID=(t.container?t.container.id:t.containerId)||"dwtcontrolContainer",n._containerElement=s.get(n._containerID),n._strWidth=t.width||270,n._strHeight=t.height||350,s.isString(n._strWidth)&&n._strWidth.indexOf("%")>0||(n._strWidth=[parseInt(n._strWidth),"px"].join("")),s.isString(n._strHeight)&&n._strHeight.indexOf("%")>0||(n._strHeight=[parseInt(n._strHeight),"px"].join("")),n._strObjectName=n._containerID+"_Obj",function(e,n){n&&a.Lib.each(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx","onRemoteScanStatusAsync","onKeyDown","onMouseWheel"],(function(t){e["__O"+t.substring(1)]=n[t]||""}))}(n,t),n.__OnPluginReady=t.onPluginReady,n.__OnPluginNotReady=t.onPluginNotReady,n.__OnRefreshUI=t.onRefreshUI||"",n._objectWebTwain=null,n._strDWTInnerContainerID=n._containerID+"_CID",n._strDWTNonInstallInnerContainerID=n._containerID+"_NonInstallCID",n.Addon={},n._pdfConvertMode=3,n._pdfRealConvertMode=3,n._bAx=!0,s.UI.DWTAxViewer&&(n.Viewer=new s.UI.DWTAxViewer(n))}(zr=qr.prototype).getSWebTwain=function(){return this._objectWebTwain},zr._isMobileMode=function(){return!1},zr.getInstance=function(){return!!this._objectWebTwain&&this},zr._createControl=function(){var e,n,t=this,r=t._strWidth,i=t._strHeight;if(s.isString(r)&&(r=r.indexOf("%")>0?"100%":parseInt(r)+2+"px"),s.isString(i)&&(i=i.indexOf("%")>0?"100%":parseInt(i)+2+"px"),n=['<div id="',t._strDWTInnerContainerID,'" style="width:',r,";height:",i,'">'],Yr.bIE)a.DWT.ActiveXInstallWithCAB?n.push('<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' codebase="',Yr.bWin64?s.product.getActiveXCABx64Path():s.product.getActiveXCABx86Path(),"#version=",a.DWT.ActiveXVersion,'"',' classid="clsid:',s.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):n.push('<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',s.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var o=t._strWidth;s.isString(o)&&-1==o.indexOf("%")&&(o=parseInt(o)-2+"px"),n.push('<embed id="',t._strObjectName,'" style="display: inline; width:',o,";height:",t._strHeight,'" type="',s.product.strMIMEType,'"',' pluginspage="',Yr.bWin?s.product.getMSIPath():s.product.getPKGPath(),'"></embed>')}n.push('</div><div id="',t._strDWTNonInstallInnerContainerID,'" style="width: ',r,';display:none"></div>'),(e=t._containerElement)&&(e.innerHTML=n.join("")),t._objectWebTwain=s.get(t._strObjectName)},zr._createNonAllowedDivPlugin=function(){var e=this,n=s.get(e._strDWTNonInstallInnerContainerID);if(""==n.innerHTML){var t=e._strHeight;s.isString(t)&&-1==t.indexOf("%")&&(t=parseInt(t)-10+"px");var r=['<div style="display: block; border:1px solid black; width:',e._strWidth,";height:",t,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");n.innerHTML=r;for(var i=0;i<Jr.links.length;i++)"DWT_CloseNonAllowedDiv"==Jr.links[i].className&&(Jr.links[i].onclick=o)}function o(){s.get(e._strDWTNonInstallInnerContainerID).style.display="none",s.get(e._strDWTInnerContainerID).style.display="inline"}},zr.__unload=zr.dispose=function(){var e,n=this;if(n._containerElement)e=n._containerElement;else{var t=n._containerID;t&&(e=s.get(t))}e&&(e.innerHTML=""),this._containerElement=null},zr._getErrorString=function(){return this._errorString},s.detect._controlDetect=function(){var e=s.detect.arySTwains,n=e[0],t=n&&n._objectWebTwain;if(t){var r,i=a.DWT,o=!1;if(Yr.bIE)r=!a.navInfo.bOSx64||a.navInfo.bWOW64?"DynamicPdfCore_"+i.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+i.ActiveXPdfVersion+".dll",0==t.ErrorCode&&""!=t.GetAddOnVersion("pdf",r)&&(o=!0);else 0==t.ErrorCode&&(o=!0);if(o){clearInterval(s.detect._varSeed);var u=function(n,t,r){var i,o;for(i=0;i<e.length;i++)o=e[i],s.attachProperty(o),s.attachMethod(o),o._attachEvents(),s.detect.ssl&&(o.IfSSL=!0,o.HTTPPort=443),0==n?o.GetLicenseInfo(t).then((function(e){e&&o._setConvertMode(o._pdfConvertMode)})):(o._blts=!0,""!=t&&""!=r?(o.SetLTSInfo(t,r),o.GetLicenseInfo().then((function(e){e&&o._setConvertMode(o._pdfConvertMode),a.DWT.lcheckLic(a.DWT.EnumInstance.dwt_desktop,e,"")}))):o.__licenseInfo={LTS:!0,Detail:[]},a.DWT.laddDWTObj(o)),s.attachAddon(o),o._objectWebTwain.BrokerProcessType=s.product._iBrokerProcessType,Yr.bWin||(o._objectWebTwain.ImageCaptureDriverType=s.product._iImageCaptureDriverType),s.isFunction(o.__OnPluginReady)&&o.__OnPluginReady()};if(s.License.isLTS()){var c=a.DWT.li({instanceMode:a.DWT.EnumInstance.dwt_desktop,axInstance:t},"");if(!a.DWT.lisValidID(c))return void u(1,"","");Ut(a.DWT.EnumInstance.dwt_desktop,"").then((function(e){u(1,e.ar,e.cu)}),(function(e){e&&(a.DWT.lsetException(e.code||e.ltsErrorCode,e.message,!0),a.DWT.OnLicenseException()),u(1,"","")}))}else u(0,i.ProductKey,"")}else s.detect.bNoControlEvent||(s.noControl(n),s.detect.bNoControlEvent=!0),s.isFunction(n.__OnPluginNotReady)&&n.__OnPluginNotReady()}else clearInterval(s.detect._varSeed)},s.ie={},s.ie.DynamicWebTwain=function(e){var n=new qr(e);return n._createControl(),s.detect.arySTwains.push(n),n},s.ie.closeAll=function(){var e,n,t,r=s.detect.arySTwains;for(e=0;e<r.length;e++)(n=r[e])&&n._objectWebTwain&&(t=n._objectWebTwain)&&0==t.ErrorCode&&t.RemoveAllImages();s.detect.arySTwains=[]},s.closeAll=s.ie.closeAll,a.DWT.RemoveAllAuthorizations=function(){return!1};var Qr,Zr=s.win;Zr.console=Zr.console||((Qr={}).log=Qr.warn=Qr.debug=Qr.info=Qr.error=Qr.time=Qr.dir=Qr.profile=Qr.clear=Qr.exception=Qr.trace=Qr.assert=function(){},Qr),Zr.addEventListener("beforeunload",(function(){a.Lib.page.bUnload=!0,a.DWT.Unload(),a.Lib.page.OnUnload&&a.Lib.page.OnUnload()}));var $r,ei,ni=function(e){var n=e.VersionInfo;if(!s.detect.bNeedUpgradeEvent&&!function(e){if(g.isUndefined(e))return!1;var n,t,r=Gr(e.toString().toLowerCase());n=g.product.bActiveXEdition?T.DWT.ActiveXVersion:g.product.getServerVersionInfo(!0),t=(n=g.replaceAll(String(n),"[.]",",")).split(",");for(var i=r.length>t.length?r.length:t.length,o=0;o<i;o++){if(null==r[o]&&(r[o]=0),null==t[o]&&(t[o]=0),parseInt(r[o])<parseInt(t[o]))return!1;if(parseInt(r[o])>parseInt(t[o]))return!0}return!0}(n)){if(s.detect.bNeedUpgradeEvent=m,s.isFunction(a.DWT.OnWebTwainNeedUpgrade)&&a.DWT.OnWebTwainNeedUpgrade())return;var t=e._containerElement;t&&(s.one(t).before(s.install._strNonInstallDIV),s.show(s.install._divDWTNonInstallContainerID),s.hide(t)),""!=s.install._divDWTemessageContainer&&s.hide(s.install._divDWTemessageContainer),function(e,n){var t=a.navInfoSync;if(s.isFunction(a.OnWebTwainNeedUpgradeCallback)){var r,i,o={};if(t.bWin){if(t.bIE)i=a.dcp.getDSPath();else{var u=s.product;i=u.bHTML5Edition?a.dcp.getDSPath():u.getMSIPath()}r=P}o["default"]=i;var c=s.one(".dynamsoft-dialog-license");c&&c.getEL()&&(c.getEL().style.display="none"),s.detect.needUpgrade=m,a.OnWebTwainNeedUpgradeCallback(s.product.name,o,s.product.bHTML5Edition,r,t.bIE,t.bSafari,s.detect.ssl,s.env.strIEVersion,s.detect.bPromptJSOrServerOutdated,e,n)}}()}};function ti(e,n,t){var r,i,o,u,c={id:e.WebTwainId,width:e.Width,height:e.Height};if(e.Container?(c.container=e.Container,c.containerId=e.Container.id):e.ContainerId&&(c.container=s.get(e.ContainerId),c.containerId=e.ContainerId),be(c.id)||(Pe(s.get(c.containerId))?c.id=c.containerId:c.id=c.containerId="dwtcontrolContainer"),function(e){var n=e||{};n.basePath&&(g.env.basePath=n.basePath),n.pathType&&(g.env.pathType=n.pathType),g.isUndefined(n.bDiscardBlankImage)||(g.config.bDiscardBlankImage=n.bDiscardBlankImage),n.msgPrefix&&(g.config.msgPrefix=n.msgPrefix),n.msgSuffix&&(g.config.msgSuffix=n.msgSuffix),n.detectType&&(g.detect.detectType=n.detectType),n.tryTimes&&(g.detect.tryTimes=n.tryTimes),n.onReady&&(T.DWT.OnWebTwainReady=n.onReady);var t=T.DWT.RemoteScanConfig;t||(t={sessionTimeout:300,keepAwake:!0},T.DWT.RemoteScanConfig=t),t.keepAwake===undefined&&(t.keepAwake=!0)}(c),c.onPluginReady=function(){if(a.DWT.ContainerMap[c.id]=r.getInstance(),s.isFunction(n)){var e={stwain:r.getInstance(),bError:!1};n(e)}},c.onPluginNotReady=function(){if(s.isFunction(Zr.Dynamsoft_OnNotReady)&&Zr.Dynamsoft_OnNotReady(),s.isFunction(t)){t({bError:!0})}},r=new s.ie.DynamicWebTwain(c),o=0,u=a.DWT.Containers)for(i=u.length-1;i>=0;i--){var l=u[i];l.Container?Pe(l.Container)&&o++:l.ContainerId&&Pe(s.get(l.ContainerId))&&o++}return s.detect.arySTwains.length==o&&(s.detect._varSeed=setInterval(s.detect._controlDetect,200)),r}function ri(){if(!s.detect.axAutoLoadDone){var e,n=a.DWT.Containers;if(n)for(e=0;e<n.length;e++){var t=void 0;if(Pe(s.get(n[e].ContainerId))&&(t=n[e].ContainerId,be(n[e].WebTwainId)&&(t=n[e].WebTwainId)),t)if(!a.DWT.ContainerMap[t])return void setTimeout(ri,200)}n=null,function(){var e,n,t,r,i,o=a.DWT.Containers,u=s.Promise.resolve(0),c=a.DWT.licenseException;if(o&&o.length>0){for(0==c.code?Zr.DCP_DWT_OnClickCloseInstall(!1,!0):s.error(c.message),n=0;n<o.length;n++)if(s.product.bActiveXEdition){if(o[n].Container?r=o[n].Container:o[n].ContainerId&&(r=s.get(o[n].ContainerId)),!Pe(r)||!r.id)continue;if(i=a.DWT.ContainerMap[r.id])break;if(t=o[n].WebTwainId,i=a.DWT.ContainerMap[t])break}i&&ni(i)}var l=!1;for(s.License.isLTS()&&s.isNumber(c.code)&&0!==c.code&&!0===c.fromLTS&&(l=!0),n=0;n<o.length;n++)s.product.bActiveXEdition&&(t=o[n].ContainerId,(e=a.DWT.ContainerMap[t])||(t=o[n].WebTwainId)),(e=a.DWT.ContainerMap[t])&&(l?s.product.bActiveXEdition&&s.hide(e._containerElement):s.product.bActiveXEdition&&(e.IfAllowLocalCache=!0,e.IfShowFileDialog=!0,e.IfDisableSourceAfterAcquire=!0,e.BrokerProcessType=s.product._iBrokerProcessType,0==n&&e.__licenseInfo&&(s.License.checkProductKey(e,{Core:!0})||a.navInfoSync.bWin&&s.License.checkProductKey(e,{Webcam:!0},!0)||s.License.checkProductKey(e,{Core:!0},!1,!0)))),e=null;o=null,l?(a.DWT.ContainerMap={},s.detect.arySTwains.splice(0)):u=u.then((function(){s.isFunction(a.DWT.OnWebTwainReady)?a.DWT.OnWebTwainReady():s.isFunction(Zr.Dynamsoft_OnReady)&&Zr.Dynamsoft_OnReady()}),(function(e){s.error(e)}))}(),s.detect.axAutoLoadDone=!0,$r()}}a.DWT._innerLoad=n(o.mark((function ui(){var e,n,t,r;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s.page.bUnload=I,s.License.isLicenseMixed(null,!0)||a.Lib.License.reparseProductKey(),0==(e=a.DWT.licenseException).code){i.next=6;break}return s.License.showLicenseErrorDialog(e),i.abrupt("return",I);case 6:if((n=a.DWT.Containers)&&0!==n.length){i.next=10;break}return s.log("Dynamsoft.DWT.Containers was not set."),i.abrupt("return",I);case 10:for(t=0;t<n.length;t++)r=n[t],!s.isString(r.WebTwainId)||s.isString(r.ContainerId)&&""!=r.ContainerId||(r.ContainerId=r.WebTwainId),u=void 0,(o=r).Container?u=o.Container.id:o.ContainerId&&(u=o.ContainerId),(Pe(s.get(u))?(s.isString(o.WebTwainId)?a.DWT.ContainerMap[o.WebTwainId]:a.DWT.ContainerMap[u])?I:m:I)&&ti(r,(function(){}),(function(e){ei(e),s.detect.axAutoLoadDone=!0}));return i.abrupt("return",s.detect.axAutoLoadDone?s.Promise.resolve():new s.Promise((function(e,n){$r=e,ei=n,setTimeout(ri,200)})));case 12:case"end":return i.stop()}var o,u}),ui)}))),a.DWT.GetWebTwain=function(e){var n,t,r,i,o=e;if(n=a.DWT.Containers,s.isString(o))o=s.get(o);else if(s.isDOM(o));else if(!o&&n&&n.length>0)for(r=0;r<n.length;r++){if(n[r].Container){o=n[r].Container;break}if(n[r].ContainerId&&Pe(s.get(n[r].ContainerId))){o=s.get(n[r].ContainerId);break}}var u=a.DWT.ContainerMap;if(o&&u&&n&&n.length>0)for(r=0;r<n.length;r++)if(i=!1,(t=n[r]).Container){if(t.Container==o&&(i=be(t.WebTwainId)?t.WebTwainId:t.Container.id)&&i in u)return u[i]}else if(t.ContainerId&&t.ContainerId==o.id&&(i=be(t.WebTwainId)?t.WebTwainId:t.ContainerId)&&i in u)return u[i];return a.DWT.GetWebTwainEx(e)},a.DWT.GetWebTwainEx=function(e){var n=e;if(s.isDOM(n)&&(n=n.id),n){var t=a.DWT.ContainerMap;if(t&&n in t)return t[n]}return null}}();
